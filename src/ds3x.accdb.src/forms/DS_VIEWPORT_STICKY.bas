Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    FastLaserPrinting = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    KeyPreview = NotDefault
    DataEntry = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularCharSet =177
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =690
    DatasheetFontHeight =11
    ItemSuffix =1591
    Left =4065
    Top =3030
    Right =21780
    Bottom =15225
    RecSrcDt = Begin
        0x4a0577b4d2d8e540
    End
    DatasheetFontName ="Calibri"
    OnKeyDown ="[Event Procedure]"
    OnKeyUp ="[Event Procedure]"
    AllowDatasheetView =0
    OnMouseWheel ="[Event Procedure]"
    FilterOnLoad =0
    SplitFormDatasheet =1
    SplitFormDatasheet =1
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =255
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            Width =850
            Height =850
            BorderShade =65.0
            GridlineShade =65.0
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            Width =1701
            Height =1701
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin BoundObjectFrame
            AddColon = NotDefault
            SizeMode =3
            SpecialEffect =2
            BorderLineStyle =0
            Width =4536
            Height =2835
            LabelX =-1701
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ListBox
            BorderLineStyle =0
            Width =1701
            Height =1417
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            Width =1701
            Height =1701
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            Width =4536
            Height =2835
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin PageBreak
            Width =283
        End
        Begin CustomControl
            OldBorderStyle =1
            Width =4536
            Height =2835
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Tab
            Width =5103
            Height =3402
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =3
            BackThemeColorIndex =1
            BackShade =85.0
            BorderLineStyle =0
            BorderThemeColorIndex =2
            BorderTint =60.0
            HoverThemeColorIndex =1
            PressedThemeColorIndex =1
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin Page
            Width =1701
            Height =1701
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin EmptyCell
            Height =240
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin NavigationControl
            BorderWidth =1
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin NavigationButton
            Width =283
            Height =283
            ForeColor =-2
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            HoverColor =-2
            HoverThemeColorIndex =2
            HoverTint =20.0
            PressedColor =-2
            PressedThemeColorIndex =2
            PressedTint =60.0
            HoverForeColor =-2
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeColor =-2
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            BackThemeColorIndex =1
            OldBorderStyle =0
            BorderLineStyle =0
            BorderThemeColorIndex =3
            BorderShade =90.0
            ThemeFontIndex =1
            FontName ="Calibri"
            FontWeight =400
            FontSize =11
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin FormHeader
            Height =646
            Name ="FormHeaders"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =3
            Begin
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Top =255
                    Width =345
                    Height =391
                    FontSize =12
                    LeftMargin =57
                    TopMargin =57
                    BorderColor =8355711
                    ForeColor =5855577
                    Name ="DS_FULL_AXIS_SCROLLING"
                    Caption ="❖"
                    FontName ="Segoe UI Symbol"
                    OnMouseDown ="[Event Procedure]"
                    OnMouseUp ="[Event Procedure]"
                    OnMouseMove ="[Event Procedure]"
                    Tag ="⦻⌖⌬ⓢⓈ🕸☻❖"
                    ControlTipText ="(Ctrl + Space)\015\012Click and drag this icon for 2-Axis scrolling.\015\012\015"
                        "\012Hint: As with scrolling using the mouse wheel, you can increase the scrollin"
                        "g speed by holding down the Shift key."
                    GroupTable =6
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638
                    LayoutCachedTop =255
                    LayoutCachedWidth =345
                    LayoutCachedHeight =646
                    RowStart =1
                    RowEnd =1
                    LayoutGroup =1
                    ThemeFontIndex =-1
                    ForeTint =65.0
                    GroupTable =6
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =3
                    Left =345
                    Top =255
                    Width =345
                    Height =391
                    FontSize =9
                    TopMargin =29
                    RightMargin =29
                    BorderColor =8355711
                    ForeColor =5855577
                    Name ="DS_HC_2_0"
                    Caption ="⧩"
                    FontName ="Segoe UI Symbol"
                    OnClick ="[Event Procedure]"
                    OnMouseMove ="[Event Procedure]"
                    Tag ="⦻⌖⌬ⓢⓈ🕸☻❖"
                    ControlTipText ="Invert selection."
                    GroupTable =6
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638
                    LayoutCachedLeft =345
                    LayoutCachedTop =255
                    LayoutCachedWidth =690
                    LayoutCachedHeight =646
                    RowStart =1
                    RowEnd =1
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =1
                    ThemeFontIndex =-1
                    ForeTint =65.0
                    GroupTable =6
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    PictureType =2
                    Top =15
                    Width =690
                    Height =240
                    FontSize =9
                    FontWeight =100
                    ForeColor =5855577
                    Name ="DS_HC_1_0"
                    Caption ="◢"
                    OnClick ="[Event Procedure]"
                    FontName ="Segoe UI Symbol"
                    GroupTable =6
                    LeftPadding =0
                    TopPadding =15
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638

                    CursorOnHover =1
                    LayoutCachedTop =15
                    LayoutCachedWidth =690
                    LayoutCachedHeight =255
                    PictureCaptionArrangement =4
                    Alignment =3
                    ColumnEnd =1
                    LayoutGroup =1
                    ForeTint =65.0
                    Shape =0
                    Gradient =0
                    BackThemeColorIndex =3
                    BackTint =100.0
                    OldBorderStyle =0
                    BorderThemeColorIndex =0
                    BorderTint =50.0
                    ThemeFontIndex =-1
                    HoverThemeColorIndex =3
                    HoverTint =100.0
                    PressedThemeColorIndex =3
                    PressedShade =100.0
                    HoverForeThemeColorIndex =8
                    HoverForeTint =100.0
                    HoverForeShade =75.0
                    PressedForeThemeColorIndex =7
                    PressedForeTint =100.0
                    GroupTable =6
                    WebImagePaddingTop =1
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            CanShrink = NotDefault
            Height =2835
            Name ="FormDetail"
            AlternateBackThemeColorIndex =4
            AlternateBackTint =40.0
            BackThemeColorIndex =1
            BackShade =60.0
            Begin
                Begin Subform
                    Locked = NotDefault
                    CanGrow = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =215
                    OldBorderStyle =0
                    Width =690
                    Height =2835
                    TabIndex =1
                    BorderColor =10921638
                    Name ="DS_WORKSHEET_NUMBERS"
                    SourceObject ="Form.DS_WORKSHEET_NUMBERS"
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638

                    LayoutCachedWidth =690
                    LayoutCachedHeight =2835
                    ShowPageHeaderAndPageFooter =0
                End
                Begin CommandButton
                    OverlapFlags =93
                    TextFontCharSet =177
                    TextFontFamily =0
                    Width =15
                    Height =15
                    FontSize =1
                    FontWeight =100
                    Name ="HiddenControl"
                    Caption ="Comando1435"
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638

                    LayoutCachedWidth =15
                    LayoutCachedHeight =15
                    Alignment =1
                    ForeThemeColorIndex =1
                    ForeTint =100.0
                    Shape =0
                    Gradient =0
                    BackThemeColorIndex =1
                    BackTint =100.0
                    OldBorderStyle =0
                    BorderThemeColorIndex =1
                    BorderTint =100.0
                    HoverColor =-2
                    HoverThemeColorIndex =-1
                    HoverTint =80.0
                    PressedColor =-2
                    PressedThemeColorIndex =-1
                    PressedShade =80.0
                    HoverForeColor =0
                    HoverForeTint =100.0
                    PressedForeColor =0
                    PressedForeTint =100.0
                    QuickStyle =4
                    QuickStyleMask =-1009
                    Overlaps =1
                End
            End
        End
        Begin FormFooter
            Visible = NotDefault
            Height =0
            Name ="FormFooter"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit


Private pWorksheetNumbers As Form_DS_WORKSHEET_NUMBERS
Private pScrollview As Form_DS_SCROLLVIEW


Public Property Get WorksheetNumbers() As Form_DS_WORKSHEET_NUMBERS: Set WorksheetNumbers = pWorksheetNumbers: End Property
Public Property Set WorksheetNumbers(ByRef Value As Form_DS_WORKSHEET_NUMBERS): Set pWorksheetNumbers = Value: End Property

Public Property Get Scrollview() As Form_DS_SCROLLVIEW: Set Scrollview = pScrollview: End Property
Public Property Set Scrollview(ByRef Value As Form_DS_SCROLLVIEW): Set pScrollview = Value: End Property


' --- FORM EVENTS ---

Private Sub Form_MouseWheel(ByVal Page As Boolean, ByVal Count As Long)
    On Error Resume Next
    pScrollview.PropagateMouseWheel Page, Count
End Sub

Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer): pScrollview.OnKeyDownHandler KeyCode, Shift: End Sub
Private Sub Form_KeyUp(KeyCode As Integer, Shift As Integer): pScrollview.OnKeyUpHandler KeyCode, Shift: End Sub


' --- SETUP / BINDING ---

Public Sub Setup()
    Dim r As ScreenLib.RECT, b As ScreenLib.BOUNDS, t As Long
    
    Set WorksheetNumbers = Me.DS_WORKSHEET_NUMBERS.Form
    
    r = ScreenLib.GetScreenRectOfPoint(ScreenLib.PointInRect(ScreenLib.GetWindowRect(Me), DirectionType.Center), True)
    b = ScreenLib.RectToBounds(r)
    
    t = pWorksheetNumbers.MaxContentWidthLimit
    Me.Width = t
    Me.FormDetail.Height = CLng(Min(b.h * 1.95, 31500))
    With Me.DS_WORKSHEET_NUMBERS
        .Left = 0
        .Top = 0
        .Width = t
        .Height = CLng(Min(b.h * 1.95, 31500))
    End With
    Me.Width = t
End Sub


' --- EVENTS ---

Private Sub DS_FULL_AXIS_SCROLLING_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    pScrollview.PointerCapture = True
End Sub

Private Sub DS_FULL_AXIS_SCROLLING_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Static lastPointerCapture As Long
    Dim pCaptured As Boolean: pCaptured = pScrollview.PointerCapture
    
    If CLng(pCaptured) - 1 <> lastPointerCapture Then
        lastPointerCapture = CLng(pCaptured) - 1
        If pCaptured Then ScreenLib.MouseMoveCursor = True
    Else
        If Not pCaptured Then ScreenLib.MouseHelpCursor = True
    End If
    DoEvents
End Sub

Private Sub DS_FULL_AXIS_SCROLLING_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    pScrollview.PointerCapture = False
End Sub

Private Sub DS_HC_2_0_Click()
    pScrollview.TriggerClickOnInvertSelection
End Sub

Private Sub DS_HC_2_0_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
    ScreenLib.MouseHandCursor = True
    DoEvents
End Sub

Private Sub DS_HC_1_0_Click()
    Me.HiddenControl.SetFocus
    DoEvents
    
    pScrollview.TriggerClickOnSelectAll
End Sub


' --- HELPERS ---

Private Function Max(X As Variant, Y As Variant) As Variant: Max = IIf(X > Y, X, Y): End Function
Private Function Min(X As Variant, Y As Variant) As Variant: Min = IIf(X < Y, X, Y): End Function
