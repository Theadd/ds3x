Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    FastLaserPrinting = NotDefault
    MinButton = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    KeyPreview = NotDefault
    DataEntry = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularCharSet =177
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =8145
    DatasheetFontHeight =11
    ItemSuffix =1582
    Left =3225
    Top =3030
    Right =28545
    Bottom =15225
    RecSrcDt = Begin
        0x4a0577b4d2d8e540
    End
    Caption ="Create Task"
    DatasheetFontName ="Calibri"
    OnResize ="[Event Procedure]"
    OnLoad ="[Event Procedure]"
    AllowDatasheetView =0
    FilterOnLoad =0
    SplitFormDatasheet =1
    SplitFormDatasheet =1
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =255
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            Width =850
            Height =850
            BorderShade =65.0
            GridlineShade =65.0
        End
        Begin Line
            BorderLineStyle =0
            Width =1701
            BorderThemeColorIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            Width =1701
            Height =1701
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin BoundObjectFrame
            AddColon = NotDefault
            SizeMode =3
            SpecialEffect =2
            BorderLineStyle =0
            Width =4536
            Height =2835
            LabelX =-1701
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ListBox
            BorderLineStyle =0
            Width =1701
            Height =1417
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            Width =1701
            Height =1701
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            Width =4536
            Height =2835
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin PageBreak
            Width =283
        End
        Begin CustomControl
            OldBorderStyle =1
            Width =4536
            Height =2835
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Tab
            Width =5103
            Height =3402
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =3
            BackThemeColorIndex =1
            BackShade =85.0
            BorderLineStyle =0
            BorderThemeColorIndex =2
            BorderTint =60.0
            HoverThemeColorIndex =1
            PressedThemeColorIndex =1
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin Page
            Width =1701
            Height =1701
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin EmptyCell
            Height =240
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin NavigationControl
            BorderWidth =1
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin NavigationButton
            Width =283
            Height =283
            ForeColor =-2
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            HoverColor =-2
            HoverThemeColorIndex =2
            HoverTint =20.0
            PressedColor =-2
            PressedThemeColorIndex =2
            PressedTint =60.0
            HoverForeColor =-2
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeColor =-2
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            BackThemeColorIndex =1
            OldBorderStyle =0
            BorderLineStyle =0
            BorderThemeColorIndex =3
            BorderShade =90.0
            ThemeFontIndex =1
            FontName ="Calibri"
            FontWeight =400
            FontSize =11
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin Section
            CanGrow = NotDefault
            CanShrink = NotDefault
            Height =5280
            Name ="Detalle"
            AlternateBackThemeColorIndex =4
            AlternateBackTint =40.0
            BackThemeColorIndex =3
            Begin
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    EnterKeyBehavior = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextAlign =1
                    TextFontFamily =49
                    BackStyle =0
                    IMESentenceMode =3
                    Left =2910
                    Top =3000
                    Width =5070
                    Height =1440
                    FontSize =9
                    FontWeight =100
                    TabIndex =7
                    TopMargin =58
                    ForeColor =8355711
                    Name ="DS_TASK_TEXT_CONTENT"
                    FontName ="Consolas"
                    GroupTable =9
                    LeftPadding =0
                    TopPadding =119
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineColor =10921638
                    TextFormat =1
                    VerticalAnchor =2
                    ShowDatePicker =0

                    LayoutCachedLeft =2910
                    LayoutCachedTop =3000
                    LayoutCachedWidth =7980
                    LayoutCachedHeight =4440
                    ColumnEnd =1
                    LayoutGroup =8
                    BackThemeColorIndex =3
                    BorderThemeColorIndex =3
                    BorderShade =100.0
                    ThemeFontIndex =-1
                    ForeTint =50.0
                    GroupTable =9
                End
                Begin ComboBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =87
                    TextAlign =3
                    TextFontFamily =49
                    IMESentenceMode =3
                    Left =5535
                    Top =615
                    Width =2400
                    Height =330
                    FontSize =9
                    FontWeight =100
                    TabIndex =2
                    BorderColor =16777215
                    Name ="DS_TASK_PARAM_0"
                    RowSourceType ="Value List"
                    FontName ="Consolas"
                    OnChange ="[Event Procedure]"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    AllowValueListEdits =0
                    LeftMargin =31
                    TopMargin =58
                    RightMargin =72

                    LayoutCachedLeft =5535
                    LayoutCachedTop =615
                    LayoutCachedWidth =7935
                    LayoutCachedHeight =945
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =2
                    ThemeFontIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =0
                    ForeTint =65.0
                    ForeShade =100.0
                    GroupTable =3
                    Begin
                        Begin Label
                            Visible = NotDefault
                            BackStyle =1
                            OldBorderStyle =1
                            OverlapFlags =93
                            TextAlign =1
                            Left =2895
                            Top =615
                            Width =2640
                            Height =330
                            FontSize =10
                            FontWeight =100
                            LeftMargin =113
                            TopMargin =40
                            RightMargin =57
                            ForeColor =5855577
                            Name ="DS_LABEL_TASK_PARAM_0"
                            GroupTable =3
                            LeftPadding =0
                            TopPadding =0
                            RightPadding =0
                            BottomPadding =0
                            GridlineStyleLeft =1
                            GridlineStyleTop =1
                            GridlineStyleBottom =1
                            GridlineColor =10921638
                            LayoutCachedLeft =2895
                            LayoutCachedTop =615
                            LayoutCachedWidth =5535
                            LayoutCachedHeight =945
                            LayoutGroup =2
                            BorderThemeColorIndex =1
                            BorderTint =100.0
                            ForeTint =65.0
                            GroupTable =3
                        End
                    End
                End
                Begin ComboBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =87
                    TextAlign =3
                    TextFontFamily =49
                    IMESentenceMode =3
                    Left =5535
                    Top =1065
                    Width =2400
                    Height =330
                    FontSize =9
                    FontWeight =100
                    TabIndex =3
                    BorderColor =16777215
                    Name ="DS_TASK_PARAM_1"
                    RowSourceType ="Value List"
                    FontName ="Consolas"
                    OnChange ="[Event Procedure]"
                    GroupTable =4
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    AllowValueListEdits =0
                    LeftMargin =31
                    TopMargin =58
                    RightMargin =72

                    LayoutCachedLeft =5535
                    LayoutCachedTop =1065
                    LayoutCachedWidth =7935
                    LayoutCachedHeight =1395
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =3
                    ThemeFontIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =0
                    ForeTint =65.0
                    ForeShade =100.0
                    GroupTable =4
                    Begin
                        Begin Label
                            Visible = NotDefault
                            BackStyle =1
                            OldBorderStyle =1
                            OverlapFlags =93
                            TextAlign =1
                            Left =2895
                            Top =1065
                            Width =2640
                            Height =330
                            FontSize =10
                            FontWeight =100
                            LeftMargin =113
                            TopMargin =40
                            RightMargin =57
                            ForeColor =5855577
                            Name ="DS_LABEL_TASK_PARAM_1"
                            GroupTable =4
                            LeftPadding =0
                            TopPadding =0
                            RightPadding =0
                            BottomPadding =0
                            GridlineStyleLeft =1
                            GridlineStyleTop =1
                            GridlineStyleBottom =1
                            GridlineColor =10921638
                            LayoutCachedLeft =2895
                            LayoutCachedTop =1065
                            LayoutCachedWidth =5535
                            LayoutCachedHeight =1395
                            LayoutGroup =3
                            BorderThemeColorIndex =1
                            BorderTint =100.0
                            ForeTint =65.0
                            GroupTable =4
                        End
                    End
                End
                Begin ComboBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =87
                    TextAlign =3
                    TextFontFamily =49
                    IMESentenceMode =3
                    Left =5535
                    Top =1515
                    Width =2400
                    Height =330
                    FontSize =9
                    FontWeight =100
                    TabIndex =4
                    BorderColor =16777215
                    Name ="DS_TASK_PARAM_2"
                    RowSourceType ="Value List"
                    FontName ="Consolas"
                    GroupTable =5
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    AllowValueListEdits =0
                    LeftMargin =31
                    TopMargin =58
                    RightMargin =72

                    LayoutCachedLeft =5535
                    LayoutCachedTop =1515
                    LayoutCachedWidth =7935
                    LayoutCachedHeight =1845
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =4
                    ThemeFontIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =0
                    ForeTint =65.0
                    ForeShade =100.0
                    GroupTable =5
                    Begin
                        Begin Label
                            Visible = NotDefault
                            BackStyle =1
                            OldBorderStyle =1
                            OverlapFlags =93
                            TextAlign =1
                            Left =2895
                            Top =1515
                            Width =2640
                            Height =330
                            FontSize =10
                            FontWeight =100
                            LeftMargin =113
                            TopMargin =40
                            RightMargin =57
                            ForeColor =5855577
                            Name ="DS_LABEL_TASK_PARAM_2"
                            GroupTable =5
                            LeftPadding =0
                            TopPadding =0
                            RightPadding =0
                            BottomPadding =0
                            GridlineStyleLeft =1
                            GridlineStyleTop =1
                            GridlineStyleBottom =1
                            GridlineColor =10921638
                            LayoutCachedLeft =2895
                            LayoutCachedTop =1515
                            LayoutCachedWidth =5535
                            LayoutCachedHeight =1845
                            LayoutGroup =4
                            BorderThemeColorIndex =1
                            BorderTint =100.0
                            ForeTint =65.0
                            GroupTable =5
                        End
                    End
                End
                Begin ComboBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =87
                    TextAlign =3
                    TextFontFamily =49
                    IMESentenceMode =3
                    Left =5535
                    Top =1965
                    Width =2400
                    Height =330
                    FontSize =9
                    FontWeight =100
                    TabIndex =5
                    BorderColor =16777215
                    Name ="DS_TASK_PARAM_3"
                    RowSourceType ="Value List"
                    FontName ="Consolas"
                    GroupTable =6
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    AllowValueListEdits =0
                    LeftMargin =31
                    TopMargin =58
                    RightMargin =72

                    LayoutCachedLeft =5535
                    LayoutCachedTop =1965
                    LayoutCachedWidth =7935
                    LayoutCachedHeight =2295
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =5
                    ThemeFontIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =0
                    ForeTint =65.0
                    ForeShade =100.0
                    GroupTable =6
                    Begin
                        Begin Label
                            Visible = NotDefault
                            BackStyle =1
                            OldBorderStyle =1
                            OverlapFlags =93
                            TextAlign =1
                            Left =2895
                            Top =1965
                            Width =2640
                            Height =330
                            FontSize =10
                            FontWeight =100
                            LeftMargin =113
                            TopMargin =40
                            RightMargin =57
                            ForeColor =5855577
                            Name ="DS_LABEL_TASK_PARAM_3"
                            GroupTable =6
                            LeftPadding =0
                            TopPadding =0
                            RightPadding =0
                            BottomPadding =0
                            GridlineStyleLeft =1
                            GridlineStyleTop =1
                            GridlineStyleBottom =1
                            GridlineColor =10921638
                            LayoutCachedLeft =2895
                            LayoutCachedTop =1965
                            LayoutCachedWidth =5535
                            LayoutCachedHeight =2295
                            LayoutGroup =5
                            BorderThemeColorIndex =1
                            BorderTint =100.0
                            ForeTint =65.0
                            GroupTable =6
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    EnterKeyBehavior = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextAlign =1
                    TextFontFamily =49
                    BackStyle =0
                    IMESentenceMode =3
                    Left =2910
                    Top =165
                    Width =5070
                    Height =345
                    FontSize =8
                    FontWeight =100
                    TabIndex =1
                    TopMargin =58
                    ForeColor =5026082
                    Name ="DS_TASK_DEFINITION_SYNTAX"
                    FontName ="Consolas"
                    GroupTable =7
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleBottom =1
                    GridlineColor =10921638
                    TextFormat =1
                    ShowDatePicker =0

                    LayoutCachedLeft =2910
                    LayoutCachedTop =165
                    LayoutCachedWidth =7980
                    LayoutCachedHeight =510
                    ColumnEnd =1
                    LayoutGroup =6
                    BackThemeColorIndex =3
                    BorderThemeColorIndex =3
                    BorderShade =100.0
                    ThemeFontIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    GroupTable =7
                End
                Begin ComboBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =87
                    TextAlign =3
                    TextFontFamily =49
                    IMESentenceMode =3
                    Left =5535
                    Top =2415
                    Width =2400
                    Height =330
                    FontSize =9
                    FontWeight =100
                    TabIndex =6
                    BorderColor =16777215
                    Name ="DS_TASK_PARAM_4"
                    RowSourceType ="Value List"
                    FontName ="Consolas"
                    GroupTable =8
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    AllowValueListEdits =0
                    LeftMargin =31
                    TopMargin =58
                    RightMargin =72

                    LayoutCachedLeft =5535
                    LayoutCachedTop =2415
                    LayoutCachedWidth =7935
                    LayoutCachedHeight =2745
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =7
                    ThemeFontIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =0
                    ForeTint =65.0
                    ForeShade =100.0
                    GroupTable =8
                    Begin
                        Begin Label
                            Visible = NotDefault
                            BackStyle =1
                            OldBorderStyle =1
                            OverlapFlags =93
                            TextAlign =1
                            Left =2895
                            Top =2415
                            Width =2640
                            Height =330
                            FontSize =10
                            FontWeight =100
                            LeftMargin =113
                            TopMargin =40
                            RightMargin =57
                            ForeColor =5855577
                            Name ="DS_LABEL_TASK_PARAM_4"
                            GroupTable =8
                            LeftPadding =0
                            TopPadding =0
                            RightPadding =0
                            BottomPadding =0
                            GridlineStyleLeft =1
                            GridlineStyleTop =1
                            GridlineStyleBottom =1
                            GridlineColor =10921638
                            LayoutCachedLeft =2895
                            LayoutCachedTop =2415
                            LayoutCachedWidth =5535
                            LayoutCachedHeight =2745
                            LayoutGroup =7
                            BorderThemeColorIndex =1
                            BorderTint =100.0
                            ForeTint =65.0
                            GroupTable =8
                        End
                    End
                End
                Begin Rectangle
                    SpecialEffect =0
                    BackStyle =1
                    OldBorderStyle =0
                    OverlapFlags =93
                    Top =4590
                    Width =8145
                    Height =690
                    BackColor =-2147483603
                    Name ="DS_FOOTER_BG"
                    GroupTable =10
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    VerticalAnchor =1
                    LayoutCachedTop =4590
                    LayoutCachedWidth =8145
                    LayoutCachedHeight =5280
                    LayoutGroup =9
                    GridlineThemeColorIndex =1
                    GridlineShade =50.0
                    GroupTable =10
                End
                Begin CommandButton
                    OverlapFlags =215
                    TextFontCharSet =177
                    Left =6690
                    Top =4755
                    Width =1245
                    Height =360
                    FontSize =10
                    TabIndex =11
                    Name ="DS_ADD_TASK_BUTTON"
                    Caption ="ADD TASK"
                    OnClick ="[Event Procedure]"
                    GroupTable =11
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =15
                    BottomPadding =15
                    GridlineColor =10921638
                    HorizontalAnchor =1
                    VerticalAnchor =1

                    CursorOnHover =1
                    LayoutCachedLeft =6690
                    LayoutCachedTop =4755
                    LayoutCachedWidth =7935
                    LayoutCachedHeight =5115
                    LayoutGroup =10
                    ForeThemeColorIndex =1
                    ForeTint =100.0
                    Shape =0
                    Gradient =0
                    BackThemeColorIndex =8
                    BackTint =100.0
                    BorderWidth =1
                    BorderThemeColorIndex =8
                    BorderTint =100.0
                    ThemeFontIndex =-1
                    HoverThemeColorIndex =8
                    HoverTint =80.0
                    PressedThemeColorIndex =8
                    PressedShade =80.0
                    HoverForeThemeColorIndex =1
                    HoverForeTint =100.0
                    PressedForeThemeColorIndex =1
                    PressedForeTint =100.0
                    GroupTable =11
                    QuickStyle =13
                    QuickStyleMask =-1
                    Overlaps =1
                End
                Begin CommandButton
                    OverlapFlags =215
                    TextFontCharSet =177
                    Left =5295
                    Top =4755
                    Width =1245
                    Height =360
                    FontSize =10
                    TabIndex =10
                    Name ="DS_CANCEL_BUTTON"
                    Caption ="CANCEL"
                    OnClick ="[Event Procedure]"
                    GroupTable =12
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =15
                    BottomPadding =15
                    GridlineColor =10921638
                    HorizontalAnchor =1
                    VerticalAnchor =1

                    CursorOnHover =1
                    LayoutCachedLeft =5295
                    LayoutCachedTop =4755
                    LayoutCachedWidth =6540
                    LayoutCachedHeight =5115
                    LayoutGroup =11
                    ForeThemeColorIndex =1
                    ForeTint =100.0
                    Shape =0
                    Gradient =0
                    BackThemeColorIndex =8
                    BackTint =100.0
                    BorderWidth =1
                    BorderThemeColorIndex =8
                    BorderTint =100.0
                    ThemeFontIndex =-1
                    HoverThemeColorIndex =8
                    HoverTint =80.0
                    PressedThemeColorIndex =8
                    PressedShade =80.0
                    HoverForeThemeColorIndex =1
                    HoverForeTint =100.0
                    PressedForeThemeColorIndex =1
                    PressedForeTint =100.0
                    GroupTable =12
                    QuickStyle =13
                    QuickStyleMask =-1
                    Overlaps =1
                End
                Begin Line
                    OverlapFlags =85
                    Top =15
                    Width =8145
                    Name ="DS_FORM_TOP_LINE"
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    LayoutCachedTop =15
                    LayoutCachedWidth =8145
                    LayoutCachedHeight =15
                    BorderThemeColorIndex =1
                    BorderShade =50.0
                End
                Begin Subform
                    OverlapFlags =87
                    Left =495
                    Top =165
                    Width =2281
                    Height =4260
                    BorderColor =16777215
                    Name ="DS_CREATE_TASK_LIST"
                    SourceObject ="Form.DS_RICHTEXT_LIST"
                    GroupTable =1
                    LeftPadding =0
                    TopPadding =15
                    RightPadding =15
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineColor =10921638
                    VerticalAnchor =2

                    LayoutCachedLeft =495
                    LayoutCachedTop =165
                    LayoutCachedWidth =2776
                    LayoutCachedHeight =4425
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =1
                    BorderShade =100.0
                    GroupTable =1
                    Begin
                        Begin Label
                            Vertical = NotDefault
                            BackStyle =1
                            OldBorderStyle =1
                            OverlapFlags =93
                            TextFontCharSet =177
                            TextFontFamily =0
                            Left =165
                            Top =165
                            Width =330
                            Height =4260
                            FontSize =10
                            FontWeight =100
                            LeftMargin =58
                            ForeColor =-2147483600
                            Name ="Etiqueta1782"
                            Caption ="  A V A I L A B L E   T A S K S"
                            FontName ="Calibri Light"
                            GroupTable =1
                            LeftPadding =0
                            TopPadding =15
                            RightPadding =0
                            BottomPadding =0
                            GridlineStyleLeft =1
                            GridlineStyleTop =1
                            GridlineStyleBottom =1
                            GridlineColor =10921638
                            VerticalAnchor =2
                            LayoutCachedLeft =165
                            LayoutCachedTop =165
                            LayoutCachedWidth =495
                            LayoutCachedHeight =4425
                            LayoutGroup =1
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                            GroupTable =1
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    TextFontCharSet =177
                    Left =165
                    Top =4755
                    Width =1755
                    Height =360
                    FontSize =10
                    TabIndex =8
                    Name ="DS_ENABLE_ALL_TASKS_BUTTON"
                    Caption ="ENABLE ALL TASKS"
                    OnClick ="[Event Procedure]"
                    GroupTable =13
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =15
                    BottomPadding =15
                    GridlineColor =10921638
                    VerticalAnchor =1

                    CursorOnHover =1
                    LayoutCachedLeft =165
                    LayoutCachedTop =4755
                    LayoutCachedWidth =1920
                    LayoutCachedHeight =5115
                    LayoutGroup =12
                    ForeThemeColorIndex =1
                    ForeTint =100.0
                    Shape =0
                    Gradient =0
                    BackThemeColorIndex =8
                    BackTint =100.0
                    BorderWidth =1
                    BorderThemeColorIndex =8
                    BorderTint =100.0
                    ThemeFontIndex =-1
                    HoverThemeColorIndex =8
                    HoverTint =80.0
                    PressedThemeColorIndex =8
                    PressedShade =80.0
                    HoverForeThemeColorIndex =1
                    HoverForeTint =100.0
                    PressedForeThemeColorIndex =1
                    PressedForeTint =100.0
                    GroupTable =13
                    QuickStyle =13
                    QuickStyleMask =-1
                    Overlaps =1
                End
                Begin CommandButton
                    OverlapFlags =215
                    TextFontCharSet =177
                    Left =2115
                    Top =4755
                    Width =1440
                    Height =360
                    FontSize =10
                    TabIndex =9
                    Name ="DS_SHOW_CUSTOM_VARS_BUTTON"
                    Caption ="SHOW C. VARS"
                    OnClick ="[Event Procedure]"
                    GroupTable =13
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =15
                    BottomPadding =15
                    GridlineColor =10921638
                    VerticalAnchor =1

                    CursorOnHover =1
                    LayoutCachedLeft =2115
                    LayoutCachedTop =4755
                    LayoutCachedWidth =3555
                    LayoutCachedHeight =5115
                    ColumnStart =2
                    ColumnEnd =2
                    LayoutGroup =12
                    ForeThemeColorIndex =1
                    ForeTint =100.0
                    Shape =0
                    Gradient =0
                    BackThemeColorIndex =8
                    BackTint =100.0
                    BorderWidth =1
                    BorderThemeColorIndex =8
                    BorderTint =100.0
                    ThemeFontIndex =-1
                    HoverThemeColorIndex =8
                    HoverTint =80.0
                    PressedThemeColorIndex =8
                    PressedShade =80.0
                    HoverForeThemeColorIndex =1
                    HoverForeTint =100.0
                    PressedForeThemeColorIndex =1
                    PressedForeTint =100.0
                    GroupTable =13
                    QuickStyle =13
                    QuickStyleMask =-1
                    Overlaps =1
                End
                Begin EmptyCell
                    Left =1935
                    Top =4755
                    Width =165
                    Height =360
                    Name ="CeldaVacía1579"
                    GroupTable =13
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =15
                    BottomPadding =15
                    GridlineColor =10921638
                    VerticalAnchor =1
                    LayoutCachedLeft =1935
                    LayoutCachedTop =4755
                    LayoutCachedWidth =2100
                    LayoutCachedHeight =5115
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =12
                    GroupTable =13
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'@Folder "ds3x.UI.LiveEditor"
Option Compare Database
Option Explicit

Private WithEvents pController As dsGridController
Attribute pController.VB_VarHelpID = -1
Private WithEvents pContinuousList As Form_DS_RICHTEXT_LIST
Attribute pContinuousList.VB_VarHelpID = -1
Private WithEvents pCVarsScrollview As Form_DS_SCROLLVIEW
Attribute pCVarsScrollview.VB_VarHelpID = -1

Private pTasks As DictionaryEx
Private pSelectedTask As String
Private pTaskNames As ArrayListEx
Private pTaskGroups As DictionaryEx
Private pActiveTaskName As String
Private pActiveTaskIndex As Long
Private pEditMode As Boolean
Private pEnableAllTasks As Boolean

'    {
'      "AddRowNumbers": [
'        "AddRowNumbers",
'        [
'          "[Source]: Table, [FirstNumber = 1]: Long",
'          2,
'          [
'            ["[Source]", "Table"],
'            ["[FirstNumber = 1]", "Long"]
'          ]
'        ],
'        "",            /* Description */
'        "",            /* Usage */
'        "T"            /* TaskType */
'        "[TD]*"        /* Requires */
'      ],
'      ...
'    }
' TaskInfo(TaskName)(DS_T_PARAMS)(2)

Const DS_T_NAME As Long = 0
Const DS_T_PARAMS As Long = 1
Const DS_T_DESC As Long = 2
Const DS_T_USAGE As Long = 3
Const DS_T_TYPE As Long = 4
Const DS_T_REQUIRES As Long = 5




Property Get IsSubform() As Boolean
    On Error Resume Next
    IsSubform = Len(Me.Parent.Name) > 0
End Property

Public Property Get ActiveTaskName() As String: ActiveTaskName = pActiveTaskName: End Property
Public Property Let ActiveTaskName(ByVal Value As String): pActiveTaskName = Value: End Property
Public Property Get ActiveTaskIndex() As Long: ActiveTaskIndex = pActiveTaskIndex: End Property
Public Property Let ActiveTaskIndex(ByVal Value As Long): pActiveTaskIndex = Value: End Property
Public Property Get EditMode() As Boolean: EditMode = pEditMode: End Property
Public Property Let EditMode(ByVal Value As Boolean): pEditMode = Value: End Property

'Private pActiveTaskIndex As Long
'Private pEditMode As Boolean

Public Property Get Controller() As dsGridController
    Set Controller = pController
End Property

Public Property Set Controller(ByRef Value As dsGridController)
    Set pController = Value
    pSelectedTask = ""
    RebuildTasksList
End Property



Private Sub DS_ADD_TASK_BUTTON_Click()
    If pSelectedTask <> "" Then
        AddTaskUsingCurrentValuesAs pSelectedTask
    End If
End Sub

Private Sub DS_CANCEL_BUTTON_Click()
    DoCmd.Close acForm, "DS_CREATE_TASK", acSaveNo
End Sub

Public Sub RebuildTasksList()
    Dim TaskName As Variant, i As Long, TaskType As String, TaskList As New ArrayListEx, ActiveTaskType As String
    Dim TListType As Variant, dsT As dsTable, rsX As RecordsetEx, RequiresPattern As String, ValidRequiredType As Boolean

    Set pTasks = pController.TaskController.AvailableTasks.Tasks
    Set pTaskNames = ArrayListEx.Create(pTasks.Keys)
    Set pTaskGroups = DictionaryEx.Create()
    If pActiveTaskName = "" Then
        ActiveTaskType = ""
    Else
        ActiveTaskType = pTasks(pActiveTaskName)(DS_T_TYPE)
    End If
    
    For i = 0 To pTaskNames.Count - 1
        TaskName = pTaskNames(i)
        TaskType = pTasks(TaskName)(DS_T_TYPE)
        If TaskType = "XS" Then TaskType = "DS"
        RequiresPattern = pTasks(TaskName)(DS_T_REQUIRES)
        'Debug.Print Printf("# %1 => ActiveTaskType Like RequiresPattern: %2 Like %3 = %4", TaskName, ActiveTaskType, RequiresPattern, CBool(ActiveTaskType Like RequiresPattern))
        
        If Not pTaskGroups.Exists(TaskType) Then
            pTaskGroups.Add TaskType, ArrayListEx.Create()
        End If
        ValidRequiredType = pEnableAllTasks Or pEditMode Or (ActiveTaskType Like RequiresPattern)
        pTaskGroups(TaskType).Add Array(i, TaskName, IIf(ValidRequiredType, 1, 4))
    Next i
    
    For Each TListType In pTaskGroups.Keys
        TaskList.Add GetTaskTypeHeader(TListType)
        TaskList.AddRange pTaskGroups(TListType)
        TaskList.Add GetTaskTypeHeader("")
    Next TListType
    
    Set dsT = dsTable.Create(TaskList).SetHeaders(Array("DS_LIST_ITEM_INDEX", "DS_LIST_ITEM", "DS_LIST_ITEM_STATE"))
    Set rsX = RecordsetEx.Create(dsT.NamedRecordset)
    Set Me.DS_CREATE_TASK_LIST.Form.Recordset = rsX.Instance
    If pContinuousList Is Nothing Then
        Set pContinuousList = Me.DS_CREATE_TASK_LIST.Form
        pContinuousList.SetActiveIndex pTaskNames.IndexOf(IIf(pActiveTaskName = "", "DataSource", pActiveTaskName))
    End If
End Sub

Private Function GetTaskTypeHeader(ByVal TaskType As String) As Variant
    Static IndexCountdown As Long
    Dim Title As String
    IndexCountdown = IndexCountdown - 1
    
    Select Case TaskType
        Case "XL": Title = "XL FORMATTING"
        Case "XLG": Title = "XL GENERATION"
        Case "DS": Title = "DATA SOURCES"
        Case "T": Title = "TRANSFORMATION"
        Case "DSG": Title = "GENERATION"
        Case Else
            GetTaskTypeHeader = Array(IndexCountdown, " ", 4)
            Exit Function
    End Select
    
    GetTaskTypeHeader = Array(IndexCountdown, CreateListItemTextHeader(Title), 4)
End Function

Private Function CreateListItemTextHeader(ByVal Title As String) As String
    CreateListItemTextHeader = _
        "<div align=center><font face=""Consolas"" size=1 color=""#A5A5A5""><b>" & Title & "</b></font><font color=white size=2>&nbsp;&nbsp;.<br>" & _
        "</font><font style=""BACKGROUND-COLOR:#808080"">______ _______ _________ ________ ________ _______ ____ ______ _____</font></div>"
End Function

Private Sub DS_ENABLE_ALL_TASKS_BUTTON_Click()
    pEnableAllTasks = Not pEnableAllTasks
    RebuildTasksList
End Sub

Private Sub DS_SHOW_CUSTOM_VARS_BUTTON_Click()
    ShowAvailableCustomVars
End Sub

Private Sub DS_TASK_PARAM_0_Change()
    Dim Target As String
    
    If GetControlText(Me.DS_TASK_PARAM_0) = "< Select... >" Then
        If FileSystemLib.TryFileOpenDialog(Target) Then
            SetControlText Me.DS_TASK_PARAM_0, Target
        Else
            SetControlText Me.DS_TASK_PARAM_0, ""
        End If
    End If
End Sub

Private Sub DS_TASK_PARAM_1_Change()
    Dim Target As String, sExtension As String
    
    If GetControlText(Me.DS_TASK_PARAM_1) = "< Select... >" Then
        If pSelectedTask Like "*JSON*" Then
            sExtension = "*.json"
        Else
            sExtension = "*.xlsx"
        End If
        If FileSystemLib.TrySaveAsDialog(Target, sExtension) Then
            SetControlText Me.DS_TASK_PARAM_1, Target
        Else
            SetControlText Me.DS_TASK_PARAM_1, ""
        End If
    End If
End Sub

Private Sub Form_Load()
    ScreenLib.ScreenLib_Resync
    ScreenLib.WindowSizeTo Me, 11000, 6000
'    WindowCenterTo Me, ScreenLib.GetScreenRectOfPoint(PointInRect(GetWindowRect(Me), DirectionType.Center))
    ScreenLib.WindowAlwaysOnTop Me
    ScreenLib.SetControlAsEnabled Me.DS_ADD_TASK_BUTTON, False
End Sub

Private Sub Form_Resize()
    Me.DS_FOOTER_BG.HorizontalAnchor = acHorizontalAnchorBoth
    Me.DS_TASK_DEFINITION_SYNTAX.HorizontalAnchor = acHorizontalAnchorBoth
    Me.DS_TASK_TEXT_CONTENT.HorizontalAnchor = acHorizontalAnchorBoth
End Sub

Private Function GetReturnTypeOf(ByVal TaskName As String) As String
    GetReturnTypeOf = pController.TaskController.GetReturnTypeOf(TaskName)
End Function

Private Sub RebuildUIForTask(ByVal TaskName As String)
    Dim Task As Variant, textContent As String, TaskParams As Variant, i As Long
    On Error GoTo Finally
    
    ResetAllTaskParamTextFields
    Task = pTasks(TaskName)
    
    Me.DS_TASK_DEFINITION_SYNTAX = Task(DS_T_NAME) & " (" & Task(DS_T_PARAMS)(0) & "): " & GetReturnTypeOf(TaskName)
    Me.DS_TASK_DEFINITION_SYNTAX.Visible = True
    
    textContent = Task(DS_T_DESC)
    If Task(DS_T_USAGE) <> "" Then
        If textContent <> "" Then textContent = textContent & vbNewLine & " " & vbNewLine
        textContent = textContent & "<strong>Usage</strong>: " & Task(DS_T_USAGE)
    End If
    
    Me.DS_TASK_TEXT_CONTENT = Replace(textContent, vbNewLine, "<br>")
    
    TaskParams = Task(DS_T_PARAMS)(2)
    For i = 0 To UBound(TaskParams)
        RefillDefaultParamValues TaskName, i, TaskParams
        If EditMode And TaskName = ActiveTaskName Then
            RefillExistingParamValues TaskName, i, TaskParams, ActiveTaskIndex
        End If
    Next i
    MoveTaskTextContentToFit UBound(TaskParams) + 1
    
    For i = UBound(TaskParams) + 1 To 4
        Me.Controls("DS_TASK_PARAM_" & CStr(i)).Visible = False
        Me.Controls("DS_LABEL_TASK_PARAM_" & CStr(i)).Visible = False
    Next i
Finally:
    Me.DS_ADD_TASK_BUTTON.Caption = IIf(EditMode, "EDIT TASK", "ADD TASK")
    ScreenLib.SetControlAsEnabled Me.DS_ADD_TASK_BUTTON, True
End Sub

Private Sub MoveTaskTextContentToFit(ByVal NumParams As Long)
    Me.DS_TASK_TEXT_CONTENT.Top = 3000 - ((5 - NumParams) * 450)
End Sub

Private Sub ResetAllTaskParamTextFields()
    Dim i As Long
    On Error Resume Next
    
    For i = 0 To 4
        SetControlText Me.Controls("DS_TASK_PARAM_" & CStr(i)), ""
    Next i
End Sub

Private Sub RefillExistingParamValues(ByVal TaskName As String, ByVal ParamIndex As Long, ByVal TaskParams As Variant, ByVal TaskIndex As Long)
    On Error GoTo 0
    Dim TaskValues As Variant, v As Variant, MatchingValue As String
    
    TaskValues = pController.TaskController.RebuildSequence(TaskIndex)("Values")
    If IsArray(TaskValues) Then
        If ParamIndex <= UBound(TaskValues) Then
            Assign v, TaskValues(ParamIndex)
            If Not IsObject(v) Then
                If Not (IsNull(v) Or IsError(v) Or IsEmpty(v)) Then
                    If IsArray(v) Then
                        MatchingValue = JSON.Stringify(v)
                    Else
                        MatchingValue = CStr(v)
                    End If
                End If
            Else
                If TypeOf v Is Scripting.Dictionary Then
                    MatchingValue = JSON.Stringify(v)
                Else
                    Err.Raise 17
                End If
            End If
            If MatchingValue <> "" Then
                Me.Controls("DS_TASK_PARAM_" & CStr(ParamIndex)) = MatchingValue
            End If
        End If
    End If
End Sub

Private Sub RefillDefaultParamValues(ByVal TaskName As String, ByVal ParamIndex As Long, ByVal TaskParams As Variant)
    Dim Item As Variant, isRequired As Boolean, ParamName As String
    
    With Me.Controls("DS_TASK_PARAM_" & CStr(ParamIndex))
        .RowSourceType = "Value List"
        .RowSource = vbNullString
        .ColumnCount = 1
        .Visible = True
        ParamName = TaskParams(ParamIndex)(0)
        isRequired = Not (VBA.Mid$(ParamName, 1, 1) = "[")
        
        '"SetNumberFormat", "[Source]: Table, [ColumnIndexes]: Long|Array(), [NumberFormat]: String", _

        If ParamName Like "*ColumnIndexes*" Then
            If pController.SelectedColumnIndexes.Count >= 1 Then
                .Value = JSON.Stringify(pController.SelectedColumnIndexes)
            Else
                .Value = ""
            End If
        ElseIf ParamName Like "*TargetFile*" Then
            .AddItem ""
            .AddItem "< Select... >"
        ElseIf ParamName Like "*NumberFormat*" Then
            AddDefaultNumberFormatItems Me.Controls("DS_TASK_PARAM_" & CStr(ParamIndex))
            .Value = GetSelectedColumnNumberFormat()
        Else
            ' Select by PARAM TYPE
            Select Case TaskParams(ParamIndex)(1)
                Case "Table", "Worksheet"
                    If Not isRequired Then .AddItem ""
                    For Each Item In GetListOfPreviousTaskResults(TaskParams(ParamIndex)(1))
                        .AddItem CStr(Item)
                    Next Item
                Case "String|Dictionary"
                    ' Being PARAM TYPE "String|Dictionary", select by TASK NAME
                    Select Case TaskName
                        Case "LoadFromExcelFile", "OpenWorksheetFromFile"
                            Item = "{""UpdateLinks"": false, ""ReadOnly"": true, ""Local"": true, ""UTF8"": false, ""NoTextQualifier"": true}"
                            .AddItem ""
                            .AddItem Item
                            .Value = Item
                        Case Else
                            ' ...
                    End Select
                Case "String"
                    ' Being PARAM TYPE "String", select by PARAM NAME
                    Select Case TaskParams(ParamIndex)(0)
                        Case "TableStyle"
                            For Each Item In GetExcelTableStyles(): .AddItem CStr(Item): Next Item
                            .Value = "TableStyleMedium6"
                        Case "[ConnectionString]", "ConnectionString"
                            Item = dbQuery.ConnectionString
                            .AddItem ""
                            .AddItem CStr(Item)
                            .Value = CStr(Item)
                        Case Else
                            ' ...
                    End Select
                Case "Boolean"
                    .AddItem "true"
                    .AddItem "false"
                    If Not isRequired Then
                        On Error Resume Next
                        Item = LCase(Trim(Split(TaskParams(ParamIndex)(0), "=")(1)))
                        Item = Left(Item, Len(Item) - 1)
                        .Value = CStr(Item)
                    End If
                Case Else
                    ' ...
            End Select
        End If
    End With
    With Me.Controls("DS_LABEL_TASK_PARAM_" & CStr(ParamIndex))
        .Visible = True
        .Caption = TaskParams(ParamIndex)(0)
    End With
    
End Sub

Private Function GetListOfPreviousTaskResults(Optional ByVal TaskReturnType As String = "") As ArrayListEx
    Dim t As New ArrayListEx, i As Long, aList As ArrayListEx
    
    On Error GoTo Finally
    With pController.TaskController
        Set aList = .RebuildSequence
        
        For i = 0 To .SequenceIndex
            If TaskReturnType = "" Then
                t.Add aList(i)("Id")
            Else
                If .GetReturnTypeOf(aList(i)("TaskName")) = TaskReturnType Then
                    t.Add aList(i)("Id")
                End If
            End If
        Next i
    End With
Finally:
    Set GetListOfPreviousTaskResults = t
End Function

Private Sub AddTaskUsingCurrentValuesAs(ByVal TaskName As String)
    Dim Task As Variant, t() As Variant, TaskParams As Variant, i As Long, Item As Variant, TaskId As String
    Task = pTasks(TaskName)
    TaskParams = Task(DS_T_PARAMS)(2)
    
    If UBound(TaskParams) < 0 Then
        t = Array()
    Else
        ReDim t(0 To UBound(TaskParams))
        
        For i = 0 To UBound(TaskParams)
            If i < 5 Then
                If Nz(Me.Controls("DS_TASK_PARAM_" & CStr(i)), "") <> "" Then
                    Assign Item, ParseParamValue(Nz(Me.Controls("DS_TASK_PARAM_" & CStr(i)), ""))
                    If IsObject(Item) Then
                        Set t(i) = Item
                    Else
                        t(i) = Item
                    End If
                Else
                    t(i) = CVErr(0)
                End If
            Else
                t(i) = CVErr(0)
            End If
        Next i
    End If
    
    If EditMode Then
        TaskId = pController.TaskController.RebuildSequence(ActiveTaskIndex)("Id")
        pController.TaskController.SetTask pController.TaskController.GenerateTask(TaskName, t, TaskId).Instance, ActiveTaskIndex
        pController.TaskController.SequenceIndex = ActiveTaskIndex
    Else
        i = IIf(pController.TaskController.RebuildSequence.Count - 1 < pController.TaskController.SequenceIndex, pController.TaskController.RebuildSequence.Count - 1, pController.TaskController.SequenceIndex)
        pController.TaskController.AddTask TaskName, t
        pController.TaskController.SequenceIndex = i + 1
    End If
    DoCmd.Close acForm, "DS_CREATE_TASK", acSaveNo
End Sub

Private Function ParseParamValue(ByVal Value As String) As Variant
    On Error GoTo Fallback
    
    Select Case VBA.Mid$(LTrim(Value), 1, 1)
        Case "[", "{"
            Assign ParseParamValue, JSON.Parse(Value, True, True)
        Case Else
            ParseParamValue = Value
    End Select
    
    Exit Function
Fallback:
    ParseParamValue = Value
End Function

Private Sub pContinuousList_OnActiveIndexChange(ByVal ActiveIndex As Long)
    pSelectedTask = pTaskNames(ActiveIndex)
    RebuildUIForTask pSelectedTask
End Sub

Private Sub pController_OnChange()
    If pSelectedTask <> "" Then
        RebuildUIForTask pSelectedTask
    End If
End Sub

Private Function GetControlText(ByRef TargetControl As Access.Control) As String
    On Error Resume Next
    GetControlText = TargetControl.Value
    GetControlText = TargetControl.Text
End Function

Private Sub SetControlText(ByRef TargetControl As Access.Control, ByVal Text As String)
    On Error Resume Next
    TargetControl.Value = Text
    TargetControl.Text = Text
End Sub

Private Sub Assign(ByRef Target, Optional ByRef Value As Variant)
    If Not IsMissing(Value) Then
        If IsObject(Value) Then
            Set Target = Value
        Else
            Target = Value
        End If
    End If
End Sub

Private Function GetExcelTableStyles() As Variant
    Dim i As Long
    
    With ArrayListEx.Create()
        For i = 1 To 21: .Add "TableStyleLight" & CStr(i): Next i
        For i = 1 To 28: .Add "TableStyleMedium" & CStr(i): Next i
        For i = 1 To 11: .Add "TableStyleDark" & CStr(i): Next i
        GetExcelTableStyles = .ToArray()
    End With
End Function

Private Sub ShowAvailableCustomVars()
    Dim dsT As dsTable, r As ds3xGlobals.RECT, rScreen As ds3xGlobals.RECT
    
    If pCVarsScrollview Is Nothing Then
        Set pCVarsScrollview = New Form_DS_SCROLLVIEW
        Set dsT = dsTable.Create(dsApp.CustomVars).SetHeaders(Array("CustomVar", "Value"))
        
        pCVarsScrollview.Visible = True
        ScreenLib.WindowSizeTo pCVarsScrollview, 5160, 8000
        ScreenLib.WindowAlwaysOnTop pCVarsScrollview
        r = ScreenLib.GetWindowRect(Me)
        rScreen = ScreenLib.GetScreenRectOfPoint(ScreenLib.PointInRect(r, DirectionType.Center))
        If CLng(r.Left) - CLng(rScreen.Left) > 5160 And r.Left > rScreen.Left Then
            ScreenLib.WindowMoveTo pCVarsScrollview, CLng(r.Left) - 5160, CLng(r.Top)
        ElseIf CLng(rScreen.Right) - CLng(r.Right) > 5160 And rScreen.Right > r.Right Then
            ScreenLib.WindowMoveTo pCVarsScrollview, CLng(r.Right), CLng(r.Top)
        End If
        pCVarsScrollview.Caption = "Custom Vars"
        Set pCVarsScrollview.Table = dsT
    Else
        pCVarsScrollview.Visible = False
        pCVarsScrollview.Visible = True
    End If
End Sub

Private Sub pCVarsScrollview_OnWindowClose(Cancel As Integer)
    Set pCVarsScrollview = Nothing
End Sub

Private Sub AddDefaultNumberFormatItems(ByVal TargetControl As Access.ComboBox)
    With TargetControl
        .AddItem ""
        .AddItem "General"
        .AddItem "@"
        .AddItem "0"
        .AddItem "0%"
        .AddItem "0.00%"
        .AddItem "#,##0.00;-#,##0.00"
        .AddItem "m/d/yyyy"
        .AddItem "mm/dd/yyyy"
        .AddItem "h:mm"
        .AddItem "h:mm:ss"
        .AddItem "[h]:mm:ss"
        .AddItem "mm:ss"
        .AddItem "hh:mm"
        .AddItem "hh:mm:ss"
        .AddItem "m/d/yyyy h:mm"
        .AddItem "m/d/yyyy h:mm:ss"
        .AddItem "mm/dd/yyyy hh:mm"
        .AddItem "mm/dd/yyyy hh:mm:ss"
    End With
End Sub

Private Function GetSelectedColumnNumberFormat() As String
    Dim cIndex As Long, cIndexValid As Boolean
    On Error GoTo Finally
    
    With pController.SelectedColumnIndexes
        If .Count > 0 Then
            cIndex = CLng(.Item(0))
            cIndexValid = True
        End If
    End With
    
    If cIndexValid Then
        GetSelectedColumnNumberFormat = pController.Table.HeaderList(0)(cIndex)("NumberFormat")
    End If
Finally:
End Function
