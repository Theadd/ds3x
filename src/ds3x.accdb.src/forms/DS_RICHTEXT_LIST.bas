Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    FastLaserPrinting = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    KeyPreview = NotDefault
    DataEntry = NotDefault
    AllowDesignChanges = NotDefault
    ScrollBars =2
    ViewsAllowed =1
    TabularCharSet =177
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =1361
    DatasheetFontHeight =11
    ItemSuffix =2096
    Left =9090
    Top =4755
    Right =11100
    Bottom =8745
    RecSrcDt = Begin
        0x4a0577b4d2d8e540
    End
    Caption ="LIST"
    DatasheetFontName ="Calibri"
    OnLoad ="[Event Procedure]"
    AllowDatasheetView =0
    FilterOnLoad =0
    OrderByOnLoad =0
    SplitFormDatasheet =1
    OrderByOnLoad =0
    SplitFormDatasheet =1
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =255
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            Width =850
            Height =850
            BorderShade =65.0
            GridlineShade =65.0
        End
        Begin Line
            BorderLineStyle =0
            Width =1701
            BorderThemeColorIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            Width =1701
            Height =1701
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin BoundObjectFrame
            AddColon = NotDefault
            SizeMode =3
            SpecialEffect =2
            BorderLineStyle =0
            Width =4536
            Height =2835
            LabelX =-1701
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ListBox
            BorderLineStyle =0
            Width =1701
            Height =1417
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            Width =1701
            Height =1701
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            Width =4536
            Height =2835
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin PageBreak
            Width =283
        End
        Begin CustomControl
            OldBorderStyle =1
            Width =4536
            Height =2835
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ToggleButton
            Width =283
            Height =283
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =2
            Bevel =1
            BackThemeColorIndex =4
            BackTint =60.0
            OldBorderStyle =0
            BorderLineStyle =0
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =1
        End
        Begin Tab
            Width =5103
            Height =3402
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =3
            BackThemeColorIndex =1
            BackShade =85.0
            BorderLineStyle =0
            BorderThemeColorIndex =2
            BorderTint =60.0
            HoverThemeColorIndex =1
            PressedThemeColorIndex =1
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin Page
            Width =1701
            Height =1701
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin EmptyCell
            Height =240
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin NavigationControl
            BorderWidth =1
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin NavigationButton
            Width =283
            Height =283
            ForeColor =-2
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            HoverColor =-2
            HoverThemeColorIndex =2
            HoverTint =20.0
            PressedColor =-2
            PressedThemeColorIndex =2
            PressedTint =60.0
            HoverForeColor =-2
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeColor =-2
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            BackThemeColorIndex =1
            OldBorderStyle =0
            BorderLineStyle =0
            BorderThemeColorIndex =3
            BorderShade =90.0
            ThemeFontIndex =1
            FontName ="Calibri"
            FontWeight =400
            FontSize =11
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin FormHeader
            Visible = NotDefault
            Height =225
            Name ="FormHeader"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =2
            BackTint =20.0
            Begin
                Begin TextBox
                    Visible = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextAlign =1
                    BackStyle =0
                    IMESentenceMode =3
                    Width =15
                    Height =15
                    FontSize =1
                    LeftMargin =42
                    TopMargin =851
                    RightMargin =42
                    BackColor =13434879
                    BorderColor =13434879
                    ForeColor =8355711
                    Name ="DS_ACTIVE_INDEX"
                    FontName ="Calibri Light"
                    GroupTable =23
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleLeft =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineColor =10921638
                    ShowDatePicker =0

                    LayoutCachedWidth =15
                    LayoutCachedHeight =15
                    LayoutGroup =4
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ThemeFontIndex =-1
                    ForeTint =50.0
                    GroupTable =23
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            CanShrink = NotDefault
            Height =285
            Name ="FormDetail"
            AlternateBackThemeColorIndex =1
            BackThemeColorIndex =1
            Begin
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =93
                    IMESentenceMode =3
                    Width =15
                    Height =15
                    FontSize =1
                    TopMargin =851
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="RowHiddenControl"
                    FontName ="Calibri Light"
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638
                    ShowDatePicker =0

                    LayoutCachedWidth =15
                    LayoutCachedHeight =15
                    ThemeFontIndex =-1
                End
                Begin TextBox
                    Visible = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =93
                    TextAlign =1
                    BackStyle =0
                    IMESentenceMode =3
                    Left =45
                    Top =180
                    Width =15
                    Height =15
                    FontSize =1
                    TabIndex =4
                    LeftMargin =42
                    TopMargin =851
                    RightMargin =42
                    BackColor =13434879
                    BorderColor =13434879
                    ForeColor =8355711
                    Name ="DS_LIST_ITEM_ROW_INDEX"
                    ControlSource ="DS_LIST_ITEM_INDEX"
                    FontName ="Calibri Light"
                    GroupTable =22
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleLeft =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineColor =10921638
                    ShowDatePicker =0

                    LayoutCachedLeft =45
                    LayoutCachedTop =180
                    LayoutCachedWidth =60
                    LayoutCachedHeight =195
                    LayoutGroup =3
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ThemeFontIndex =-1
                    ForeTint =50.0
                    GroupTable =22
                End
                Begin TextBox
                    Visible = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =93
                    TextAlign =1
                    BackStyle =0
                    IMESentenceMode =3
                    Left =45
                    Top =45
                    Width =15
                    Height =15
                    FontSize =1
                    TabIndex =3
                    LeftMargin =42
                    TopMargin =851
                    RightMargin =42
                    BackColor =13434879
                    BorderColor =13434879
                    ForeColor =8355711
                    Name ="DS_LIST_ITEM_ROW_STATE"
                    ControlSource ="DS_LIST_ITEM_STATE"
                    FontName ="Calibri Light"
                    GroupTable =21
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleLeft =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineColor =10921638
                    ShowDatePicker =0

                    LayoutCachedLeft =45
                    LayoutCachedTop =45
                    LayoutCachedWidth =60
                    LayoutCachedHeight =60
                    LayoutGroup =2
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ThemeFontIndex =-1
                    ForeTint =50.0
                    GroupTable =21
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    EnterKeyBehavior = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =223
                    TextAlign =1
                    TextFontFamily =49
                    IMESentenceMode =3
                    Width =1361
                    Height =284
                    FontSize =9
                    TabIndex =1
                    LeftMargin =42
                    TopMargin =15
                    RightMargin =15
                    BorderColor =13434879
                    ForeColor =8355711
                    Name ="DS_LIST_ITEM"
                    ControlSource ="DS_LIST_ITEM"
                    FontName ="72 Monospace"
                    ConditionalFormat = Begin
                        0x0100000086010000030000000100000000000000000000004a00000001000000 ,
                        0xff505000ffffcc0001000000000000004b00000076000000010000000072bc00 ,
                        0xffffcc000100000000000000770000009200000001000000a5a5a500ffffff00 ,
                        0x5b00440053005f004c004900530054005f004900540045004d005f0052004f00 ,
                        0x57005f0049004e004400450058005d003d005b00440053005f00410043005400 ,
                        0x4900560045005f0049004e004400450058005d00200041006e00640020005b00 ,
                        0x440053005f004c004900530054005f004900540045004d005f0052004f005700 ,
                        0x5f00530054004100540045005d003d003300000000005b00440053005f004c00 ,
                        0x4900530054005f004900540045004d005f0052004f0057005f0049004e004400 ,
                        0x450058005d003d005b00440053005f004100430054004900560045005f004900 ,
                        0x4e004400450058005d00000000005b00440053005f004c004900530054005f00 ,
                        0x4900540045004d005f0052004f0057005f00530054004100540045005d003d00 ,
                        0x300000000000
                    End
                    GroupTable =18
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638
                    TextFormat =1
                    HorizontalAnchor =2
                    ShowDatePicker =0

                    LayoutCachedWidth =1361
                    LayoutCachedHeight =284
                    LayoutGroup =1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ThemeFontIndex =-1
                    ForeTint =50.0
                    ConditionalFormat14 = Begin
                        0x010006000000010000000000000001000000ff505000ffffcc00490000005b00 ,
                        0x440053005f004c004900530054005f004900540045004d005f0052004f005700 ,
                        0x5f0049004e004400450058005d003d005b00440053005f004100430054004900 ,
                        0x560045005f0049004e004400450058005d00200041006e00640020005b004400 ,
                        0x53005f004c004900530054005f004900540045004d005f0052004f0057005f00 ,
                        0x530054004100540045005d003d00330000000000000000000000000000000000 ,
                        0x00000000000100000000000000010000000072bc00ffffcc002a0000005b0044 ,
                        0x0053005f004c004900530054005f004900540045004d005f0052004f0057005f ,
                        0x0049004e004400450058005d003d005b00440053005f00410043005400490056 ,
                        0x0045005f0049004e004400450058005d00000000000000000000000000000000 ,
                        0x000000000000010000000000000001000000a5a5a500ffffff001a0000005b00 ,
                        0x440053005f004c004900530054005f004900540045004d005f0052004f005700 ,
                        0x5f00530054004100540045005d003d0030000000000000000000000000000000 ,
                        0x000000000000000100000000000000010000003f3f3f00ffffff001a0000005b ,
                        0x00440053005f004c004900530054005f004900540045004d005f0052004f0057 ,
                        0x005f00530054004100540045005d003d00310000000000000000000000000000 ,
                        0x0000000000000000010000000000000001000000ff505000ffffff001a000000 ,
                        0x5b00440053005f004c004900530054005f004900540045004d005f0052004f00 ,
                        0x57005f00530054004100540045005d003d003300000000000000000000000000 ,
                        0x000000000000000000010000000000000001000000cdcdcd00ffffff001a0000 ,
                        0x005b00440053005f004c004900530054005f004900540045004d005f0052004f ,
                        0x0057005f00530054004100540045005d003d0034000000000000000000000000 ,
                        0x00000000000000000000
                    End
                    GroupTable =18
                End
                Begin CommandButton
                    Transparent = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =247
                    TextFontFamily =49
                    Width =1361
                    Height =285
                    FontSize =10
                    TabIndex =2
                    Name ="DS_LIST_ITEM_OVERLAY"
                    OnClick ="[Event Procedure]"
                    OnDblClick ="[Event Procedure]"
                    FontName ="Consolas"
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    BackStyle =0

                    LayoutCachedWidth =1361
                    LayoutCachedHeight =285
                    ForeThemeColorIndex =5
                    ForeTint =60.0
                    BackColor =13434879
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    OldBorderStyle =0
                    BorderThemeColorIndex =0
                    BorderTint =50.0
                    ThemeFontIndex =-1
                    HoverColor =15189940
                    PressedColor =9917743
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    Overlaps =1
                End
            End
        End
        Begin FormFooter
            Visible = NotDefault
            Height =0
            Name ="FormFooter"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'@Folder "ds3x.UI.Misc"
Option Compare Database
Option Explicit
Option Base 0


Private pLastActiveIndex As Long
Private pScrollPosY As Long

Public Event OnActiveIndexChange(ByVal ActiveIndex As Long)
Public Event OnNoActiveIndexChange(ByVal ActiveIndex As Long)
Public Event OnItemDoubleClick(ByVal ActiveIndex As Long)


Property Get IsSubform() As Boolean
    On Error Resume Next
    IsSubform = Len(Me.Parent.Name) > 0
    On Error GoTo 0
End Property



Public Sub SetActiveIndex(ByVal Index As Long, Optional ByVal SkipEventPropagation As Boolean = False)
    Dim TargetIndex As Long
    
    TargetIndex = RecordsetEx.Bind(Me.Recordset.Clone).IndexOf("[DS_LIST_ITEM_INDEX] = " & CStr(Index), -1)
    If TargetIndex <> -1 Then
        Me.SelTop = TargetIndex
        DoEvents
        SetCurrentAsActiveIndex SkipEventPropagation
        DoEvents
    End If
End Sub

Private Sub DS_LIST_ITEM_OVERLAY_Click()
    On Error GoTo Finally

    If CLng(Int(Val(Nz(Me.DS_LIST_ITEM_ROW_STATE)))) = 4 Then Exit Sub
    SaveScrollPosY
    SetCurrentAsActiveIndex
    RestoreScrollPosY
    Exit Sub
Finally:
    Debug.Print "[ERROR] @DS_LIST_ITEM_OVERLAY.Click() - " & Err.Description
End Sub

Private Sub SetCurrentAsActiveIndex(Optional ByVal SkipEventPropagation As Boolean = False)
    On Error GoTo Finally
    Dim cActiveIndex As Long
    
    cActiveIndex = CLng(Int(Val(Nz(Me.DS_LIST_ITEM_ROW_INDEX))))
    If cActiveIndex <> pLastActiveIndex Then
        pLastActiveIndex = cActiveIndex
        Me.DS_ACTIVE_INDEX = cActiveIndex
        If Not SkipEventPropagation Then
            RaiseEvent OnActiveIndexChange(pLastActiveIndex)
        End If
    Else
        If Not SkipEventPropagation Then
            RaiseEvent OnNoActiveIndexChange(pLastActiveIndex)
        End If
    End If
    
    Exit Sub
Finally:
    Debug.Print "[ERROR] @DS_RICHTEXT_LIST.SetCurrentAsActiveIndex() - " & Err.Description
End Sub


Private Sub DS_LIST_ITEM_OVERLAY_DblClick(Cancel As Integer)
    On Error Resume Next
    
    If CLng(Int(Val(Nz(Me.DS_LIST_ITEM_ROW_STATE)))) = 4 Then Exit Sub
    RaiseEvent OnItemDoubleClick(CLng(Int(Val(Nz(Me.DS_LIST_ITEM_ROW_INDEX)))))
    On Error GoTo 0
End Sub

Private Sub Form_Load()
    pLastActiveIndex = -1
End Sub


Private Sub SaveScrollPosY()
    pScrollPosY = Me.SelTop - Round(Me.CurrentSectionTop / Me.FormDetail.Height)
End Sub

Private Sub RestoreScrollPosY()
    On Error Resume Next
    Me.SelTop = Me.Recordset.RecordCount
    Me.SelTop = pScrollPosY
    On Error GoTo 0
End Sub
