Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    FastLaserPrinting = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    KeyPreview = NotDefault
    DataEntry = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularCharSet =177
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =14542
    DatasheetFontHeight =11
    ItemSuffix =1572
    Left =3225
    Top =3030
    Right =28545
    Bottom =15225
    OnUnload ="[Event Procedure]"
    RecSrcDt = Begin
        0x4a0577b4d2d8e540
    End
    Caption ="ds3x - LiveEd"
    DatasheetFontName ="Calibri"
    OnTimer ="[Event Procedure]"
    OnResize ="[Event Procedure]"
    OnLoad ="[Event Procedure]"
    AllowDatasheetView =0
    FilterOnLoad =0
    SplitFormDatasheet =1
    SplitFormDatasheet =1
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =255
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            Width =850
            Height =850
            BorderShade =65.0
            GridlineShade =65.0
        End
        Begin Line
            BorderLineStyle =0
            Width =1701
            BorderThemeColorIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            Width =1701
            Height =1701
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin BoundObjectFrame
            AddColon = NotDefault
            SizeMode =3
            SpecialEffect =2
            BorderLineStyle =0
            Width =4536
            Height =2835
            LabelX =-1701
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ListBox
            BorderLineStyle =0
            Width =1701
            Height =1417
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            Width =1701
            Height =1701
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            Width =4536
            Height =2835
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin PageBreak
            Width =283
        End
        Begin CustomControl
            OldBorderStyle =1
            Width =4536
            Height =2835
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Tab
            Width =5103
            Height =3402
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =3
            BackThemeColorIndex =1
            BackShade =85.0
            BorderLineStyle =0
            BorderThemeColorIndex =2
            BorderTint =60.0
            HoverThemeColorIndex =1
            PressedThemeColorIndex =1
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin Page
            Width =1701
            Height =1701
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin EmptyCell
            Height =240
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin NavigationControl
            BorderWidth =1
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin NavigationButton
            Width =283
            Height =283
            ForeColor =-2
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            HoverColor =-2
            HoverThemeColorIndex =2
            HoverTint =20.0
            PressedColor =-2
            PressedThemeColorIndex =2
            PressedTint =60.0
            HoverForeColor =-2
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeColor =-2
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            BackThemeColorIndex =1
            OldBorderStyle =0
            BorderLineStyle =0
            BorderThemeColorIndex =3
            BorderShade =90.0
            ThemeFontIndex =1
            FontName ="Calibri"
            FontWeight =400
            FontSize =11
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin Section
            CanGrow = NotDefault
            CanShrink = NotDefault
            Height =5700
            Name ="Detalle"
            AlternateBackThemeColorIndex =4
            AlternateBackTint =40.0
            BackThemeColorIndex =3
            Begin
                Begin CommandButton
                    OverlapFlags =93
                    TextFontCharSet =177
                    TextFontFamily =0
                    Left =284
                    Top =284
                    Width =15
                    Height =15
                    FontSize =1
                    FontWeight =100
                    TabIndex =1
                    Name ="HiddenControl"
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638

                    LayoutCachedLeft =284
                    LayoutCachedTop =284
                    LayoutCachedWidth =299
                    LayoutCachedHeight =299
                    Alignment =1
                    ForeThemeColorIndex =1
                    ForeTint =100.0
                    Shape =0
                    Gradient =0
                    BackThemeColorIndex =1
                    BackTint =100.0
                    OldBorderStyle =0
                    BorderThemeColorIndex =1
                    BorderTint =100.0
                    HoverColor =-2
                    HoverThemeColorIndex =-1
                    HoverTint =80.0
                    PressedColor =-2
                    PressedThemeColorIndex =-1
                    PressedShade =80.0
                    HoverForeColor =0
                    HoverForeTint =100.0
                    PressedForeColor =0
                    PressedForeTint =100.0
                    QuickStyle =4
                    QuickStyleMask =-1009
                    Overlaps =1
                End
                Begin Subform
                    Visible = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =215
                    OldBorderStyle =0
                    Top =30
                    Width =10770
                    Height =5670
                    TabIndex =2
                    BorderColor =10921638
                    Name ="DS_MAIN_PANEL"
                    GroupTable =2
                    LeftPadding =0
                    TopPadding =15
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineColor =8355711
                    VerticalAnchor =2

                    LayoutCachedTop =30
                    LayoutCachedWidth =10770
                    LayoutCachedHeight =5700
                    ColumnEnd =6
                    LayoutGroup =1
                    GridlineShade =50.0
                    GroupTable =2
                End
                Begin Subform
                    Visible = NotDefault
                    OverlapFlags =85
                    OldBorderStyle =0
                    Left =10800
                    Top =30
                    Width =3734
                    Height =5670
                    BorderColor =10921638
                    Name ="DS_SIDE_PANEL"
                    GroupTable =2
                    LeftPadding =0
                    TopPadding =15
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineColor =8355711
                    VerticalAnchor =2

                    LayoutCachedLeft =10800
                    LayoutCachedTop =30
                    LayoutCachedWidth =14534
                    LayoutCachedHeight =5700
                    ColumnStart =8
                    ColumnEnd =8
                    LayoutGroup =1
                    GridlineShade =50.0
                    WidthStretch =33
                    GroupTable =2
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =177
                            TextAlign =1
                            TextFontFamily =0
                            Left =10770
                            Top =30
                            Width =30
                            Height =5670
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="DS_VERTICAL_SPLITTER"
                            GroupTable =2
                            LeftPadding =0
                            TopPadding =15
                            RightPadding =0
                            BottomPadding =0
                            GridlineStyleLeft =1
                            GridlineStyleTop =1
                            GridlineColor =8355711
                            VerticalAnchor =2
                            LayoutCachedLeft =10770
                            LayoutCachedTop =30
                            LayoutCachedWidth =10800
                            LayoutCachedHeight =5700
                            ColumnStart =7
                            ColumnEnd =7
                            LayoutGroup =1
                            WidthStretch =33
                            GridlineShade =50.0
                            GroupTable =2
                        End
                    End
                End
                Begin Line
                    OverlapFlags =85
                    Top =15
                    Width =14542
                    Name ="Línea1571"
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    LayoutCachedTop =15
                    LayoutCachedWidth =14542
                    LayoutCachedHeight =15
                    BorderThemeColorIndex =1
                    BorderShade =50.0
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private WithEvents pController As dsLiveEd
Attribute pController.VB_VarHelpID = -1

Property Get IsSubform() As Boolean
    On Error Resume Next
    IsSubform = Len(Me.Parent.Name) > 0
End Property

Public Property Get Controller() As dsLiveEd: Set Controller = pController: End Property
Public Property Set Controller(ByRef Value As dsLiveEd): Bind Value: End Property



Private Sub Form_Load()
    ScreenLib.ScreenLib_Resync
    
    ScreenLib.WindowSizeTo Me, 22050, 11000
    ScreenLib.WindowCenterTo Me, ScreenLib.PrimaryScreen

    Me.TimerInterval = 1
End Sub

Private Sub Bind(ByVal TargetController As dsLiveEd)
    
    If (Not TargetController Is Nothing) And (Not pController Is Nothing) Then
        ' More than one DS_LIVE_EDITOR windows can point to the same dsLiveEd controller
        ' But NOT more than one dsLiveEd instance can point to the same window, so:
        ' Unbind this form from controller's pLiveEditor if ObjPtr's of TargetController and pController differ
        If ObjPtr(pController) <> ObjPtr(TargetController) Then
            If Not pController.LiveEditor Is Nothing Then
                If ObjPtr(pController.LiveEditor) = ObjPtr(Me) Then
                    Set pController.LiveEditor = Nothing
                End If
            End If
            Set pController = Nothing
        End If
    End If
    Set pController = TargetController

    Me.DS_MAIN_PANEL.SourceObject = "Form.DS_LIVE_EDITOR_MAIN_PANEL"
    Me.DS_SIDE_PANEL.SourceObject = "Form.DS_LIVE_EDITOR_SIDE_PANEL"
    Set Me.DS_SIDE_PANEL.Form.Controller = pController
    Set Me.DS_MAIN_PANEL.Form.Controller = pController
    Me.DS_SIDE_PANEL.Visible = True
'    If pController.TaskController.Initialized Then
        Me.DS_MAIN_PANEL.Visible = True
'    End If
End Sub

Private Sub Form_Resize()
    ResizeToFitAllControls
End Sub

Private Sub Form_Timer()
    Me.TimerInterval = 0

    If pController Is Nothing Then
        Dim d As dsLiveEd
        Set d = New dsLiveEd
        Bind d
        Set d.LiveEditor = Me
        d.DisposeOnClose = True
    End If
End Sub

Private Sub Form_Unload(Cancel As Integer)
    On Error Resume Next
    pController.TriggerLiveEditorWindowClose True
    Set pController = Nothing
End Sub


Private Sub ResizeToFitAllControls()
    Dim parentWidth As Long, pSize As Long
    
    Focus Me
    parentWidth = Me.InsideWidth
    
    pSize = Me.DS_SIDE_PANEL.Width
    Me.DS_SIDE_PANEL.Left = parentWidth - pSize
    pSize = pSize + Me.DS_VERTICAL_SPLITTER.Width
    Me.DS_VERTICAL_SPLITTER.Left = parentWidth - pSize
    Me.DS_MAIN_PANEL.Width = parentWidth - (pSize + Me.DS_MAIN_PANEL.Left)
    ' Force resize event on side panel subform as quick fix for incorrect rendering
    If Me.DS_SIDE_PANEL.Width Mod 2 = 0 Then
        Me.DS_SIDE_PANEL.Width = Me.DS_SIDE_PANEL.Width - 15
    Else
        Me.DS_SIDE_PANEL.Width = Me.DS_SIDE_PANEL.Width + 15
    End If
End Sub

Private Sub pController_OnDataSourceChange()
    If Not Me.DS_MAIN_PANEL.Visible Then Me.DS_MAIN_PANEL.Visible = True
End Sub

Private Sub Focus(ByRef frm As Access.Form)
    On Error Resume Next
    frm.Controls("HiddenControl").SetFocus
    DoEvents
End Sub
