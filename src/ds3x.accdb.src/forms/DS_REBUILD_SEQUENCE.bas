Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    FastLaserPrinting = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    KeyPreview = NotDefault
    DataEntry = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularCharSet =177
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =3248
    DatasheetFontHeight =11
    ItemSuffix =1590
    Left =4065
    Top =3030
    Right =28545
    Bottom =15225
    OnUnload ="[Event Procedure]"
    RecSrcDt = Begin
        0x4a0577b4d2d8e540
    End
    Caption ="dsRebuildSequence"
    DatasheetFontName ="Calibri"
    OnResize ="[Event Procedure]"
    OnLoad ="[Event Procedure]"
    AllowDatasheetView =0
    FilterOnLoad =0
    SplitFormDatasheet =1
    SplitFormDatasheet =1
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =255
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            Width =850
            Height =850
            BorderShade =65.0
            GridlineShade =65.0
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            Width =1701
            Height =1701
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin BoundObjectFrame
            AddColon = NotDefault
            SizeMode =3
            SpecialEffect =2
            BorderLineStyle =0
            Width =4536
            Height =2835
            LabelX =-1701
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ListBox
            BorderLineStyle =0
            Width =1701
            Height =1417
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            Width =1701
            Height =1701
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            Width =4536
            Height =2835
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin PageBreak
            Width =283
        End
        Begin CustomControl
            OldBorderStyle =1
            Width =4536
            Height =2835
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Tab
            Width =5103
            Height =3402
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =3
            BackThemeColorIndex =1
            BackShade =85.0
            BorderLineStyle =0
            BorderThemeColorIndex =2
            BorderTint =60.0
            HoverThemeColorIndex =1
            PressedThemeColorIndex =1
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin Page
            Width =1701
            Height =1701
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin EmptyCell
            Height =240
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin NavigationControl
            BorderWidth =1
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin NavigationButton
            Width =283
            Height =283
            ForeColor =-2
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            HoverColor =-2
            HoverThemeColorIndex =2
            HoverTint =20.0
            PressedColor =-2
            PressedThemeColorIndex =2
            PressedTint =60.0
            HoverForeColor =-2
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeColor =-2
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            BackThemeColorIndex =1
            OldBorderStyle =0
            BorderLineStyle =0
            BorderThemeColorIndex =3
            BorderShade =90.0
            ThemeFontIndex =1
            FontName ="Calibri"
            FontWeight =400
            FontSize =11
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin FormHeader
            Visible = NotDefault
            Height =0
            Name ="EncabezadoDelFormulario"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =2
            BackTint =20.0
        End
        Begin Section
            CanGrow = NotDefault
            CanShrink = NotDefault
            Height =2153
            Name ="Detalle"
            AlternateBackThemeColorIndex =4
            AlternateBackTint =40.0
            BackThemeColorIndex =3
            Begin
                Begin Subform
                    OverlapFlags =87
                    Left =360
                    Top =30
                    Width =2865
                    Height =2123
                    BorderColor =16777215
                    Name ="DS_SEQUENCE_LIST"
                    SourceObject ="Form.DS_RICHTEXT_LIST"
                    GroupTable =1
                    LeftPadding =0
                    TopPadding =15
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineColor =8355711
                    HorizontalAnchor =2
                    VerticalAnchor =2

                    LayoutCachedLeft =360
                    LayoutCachedTop =30
                    LayoutCachedWidth =3225
                    LayoutCachedHeight =2153
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =1
                    GridlineShade =50.0
                    BorderShade =100.0
                    GroupTable =1
                    Begin
                        Begin Label
                            Vertical = NotDefault
                            BackStyle =1
                            OldBorderStyle =1
                            OverlapFlags =93
                            TextFontCharSet =177
                            TextFontFamily =0
                            Left =30
                            Top =30
                            Width =330
                            Height =2123
                            FontSize =10
                            FontWeight =100
                            LeftMargin =58
                            ForeColor =-2147483600
                            Name ="Etiqueta1782"
                            Caption ="  R E B U I L D   S E Q U E N C E"
                            FontName ="Calibri Light"
                            GroupTable =1
                            LeftPadding =15
                            TopPadding =15
                            RightPadding =0
                            BottomPadding =0
                            GridlineStyleLeft =1
                            GridlineStyleTop =1
                            GridlineColor =8355711
                            VerticalAnchor =2
                            LayoutCachedLeft =30
                            LayoutCachedTop =30
                            LayoutCachedWidth =360
                            LayoutCachedHeight =2153
                            LayoutGroup =1
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                            GridlineShade =50.0
                            GroupTable =1
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =454
            Name ="PieDelFormulario"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =3
            Begin
                Begin CommandButton
                    OverlapFlags =93
                    Left =420
                    Top =60
                    Width =750
                    Height =300
                    FontSize =8
                    Name ="DS_LIST_ITEM_REMOVE"
                    Caption ="REMOVE"
                    OnClick ="[Event Procedure]"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638
                    VerticalAnchor =1

                    CursorOnHover =1
                    LayoutCachedLeft =420
                    LayoutCachedTop =60
                    LayoutCachedWidth =1170
                    LayoutCachedHeight =360
                    RowStart =1
                    RowEnd =1
                    ColumnStart =2
                    ColumnEnd =2
                    LayoutGroup =2
                    ForeThemeColorIndex =1
                    ForeTint =100.0
                    Shape =0
                    Gradient =0
                    BackColor =13998939
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    BorderWidth =1
                    BorderThemeColorIndex =8
                    BorderTint =100.0
                    ThemeFontIndex =-1
                    HoverThemeColorIndex =8
                    HoverTint =80.0
                    PressedThemeColorIndex =8
                    PressedShade =80.0
                    HoverForeThemeColorIndex =1
                    HoverForeTint =100.0
                    PressedForeThemeColorIndex =1
                    PressedForeTint =100.0
                    GroupTable =3
                    QuickStyle =13
                    QuickStyleMask =-1
                    WebImagePaddingRight =-1
                    WebImagePaddingBottom =-1
                    Overlaps =1
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =30
                    Top =60
                    Width =330
                    Height =300
                    Name ="CeldaVacía1562"
                    GroupTable =3
                    LeftPadding =15
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleRight =1
                    GridlineColor =8355711
                    VerticalAnchor =1
                    LayoutCachedLeft =30
                    LayoutCachedTop =60
                    LayoutCachedWidth =360
                    LayoutCachedHeight =360
                    RowStart =1
                    RowEnd =1
                    LayoutGroup =2
                    GridlineShade =50.0
                    BackThemeColorIndex =3
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =1170
                    Top =60
                    Width =135
                    Height =300
                    BackColor =-2147483603
                    Name ="CeldaVacía1563"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638
                    VerticalAnchor =1
                    LayoutCachedLeft =1170
                    LayoutCachedTop =60
                    LayoutCachedWidth =1305
                    LayoutCachedHeight =360
                    RowStart =1
                    RowEnd =1
                    ColumnStart =3
                    ColumnEnd =3
                    LayoutGroup =2
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =1305
                    Top =60
                    Width =810
                    Height =300
                    BackColor =-2147483603
                    Name ="DS_FOOTER_CELL_GROW"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    VerticalAnchor =1
                    LayoutCachedLeft =1305
                    LayoutCachedTop =60
                    LayoutCachedWidth =2115
                    LayoutCachedHeight =360
                    RowStart =1
                    RowEnd =1
                    ColumnStart =4
                    ColumnEnd =4
                    LayoutGroup =2
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =360
                    Top =60
                    Width =60
                    Height =300
                    BackColor =-2147483603
                    Name ="CeldaVacía1565"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638
                    VerticalAnchor =1
                    LayoutCachedLeft =360
                    LayoutCachedTop =60
                    LayoutCachedWidth =420
                    LayoutCachedHeight =360
                    RowStart =1
                    RowEnd =1
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =2
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =30
                    Width =330
                    Height =60
                    Name ="CeldaVacía1566"
                    GroupTable =3
                    LeftPadding =15
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineColor =8355711
                    LayoutCachedLeft =30
                    LayoutCachedWidth =360
                    LayoutCachedHeight =60
                    LayoutGroup =2
                    GridlineShade =50.0
                    BackThemeColorIndex =3
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =360
                    Width =60
                    Height =60
                    BackColor =-2147483603
                    Name ="CeldaVacía1567"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineColor =10921638
                    LayoutCachedLeft =360
                    LayoutCachedWidth =420
                    LayoutCachedHeight =60
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =2
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =420
                    Width =750
                    Height =60
                    BackColor =-2147483603
                    Name ="CeldaVacía1568"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineColor =10921638
                    LayoutCachedLeft =420
                    LayoutCachedWidth =1170
                    LayoutCachedHeight =60
                    ColumnStart =2
                    ColumnEnd =2
                    LayoutGroup =2
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =1170
                    Width =135
                    Height =60
                    BackColor =-2147483603
                    Name ="CeldaVacía1569"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineColor =10921638
                    LayoutCachedLeft =1170
                    LayoutCachedWidth =1305
                    LayoutCachedHeight =60
                    ColumnStart =3
                    ColumnEnd =3
                    LayoutGroup =2
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =1305
                    Width =1365
                    Height =60
                    BackColor =-2147483603
                    Name ="CeldaVacía1570"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    LayoutCachedLeft =1305
                    LayoutCachedWidth =2670
                    LayoutCachedHeight =60
                    ColumnStart =4
                    ColumnEnd =5
                    LayoutGroup =2
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =30
                    Top =360
                    Width =330
                    Height =60
                    Name ="CeldaVacía1571"
                    GroupTable =3
                    LeftPadding =15
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleRight =1
                    GridlineColor =8355711
                    LayoutCachedLeft =30
                    LayoutCachedTop =360
                    LayoutCachedWidth =360
                    LayoutCachedHeight =420
                    RowStart =2
                    RowEnd =2
                    LayoutGroup =2
                    GridlineShade =50.0
                    BackThemeColorIndex =3
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =360
                    Top =360
                    Width =60
                    Height =60
                    BackColor =-2147483603
                    Name ="CeldaVacía1572"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleBottom =1
                    GridlineColor =8355711
                    LayoutCachedLeft =360
                    LayoutCachedTop =360
                    LayoutCachedWidth =420
                    LayoutCachedHeight =420
                    RowStart =2
                    RowEnd =2
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =2
                    GridlineShade =50.0
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =420
                    Top =360
                    Width =750
                    Height =60
                    BackColor =-2147483603
                    Name ="CeldaVacía1573"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleBottom =1
                    GridlineColor =8355711
                    LayoutCachedLeft =420
                    LayoutCachedTop =360
                    LayoutCachedWidth =1170
                    LayoutCachedHeight =420
                    RowStart =2
                    RowEnd =2
                    ColumnStart =2
                    ColumnEnd =2
                    LayoutGroup =2
                    GridlineShade =50.0
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =1170
                    Top =360
                    Width =135
                    Height =60
                    BackColor =-2147483603
                    Name ="CeldaVacía1574"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleBottom =1
                    GridlineColor =8355711
                    LayoutCachedLeft =1170
                    LayoutCachedTop =360
                    LayoutCachedWidth =1305
                    LayoutCachedHeight =420
                    RowStart =2
                    RowEnd =2
                    ColumnStart =3
                    ColumnEnd =3
                    LayoutGroup =2
                    GridlineShade =50.0
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =1305
                    Top =360
                    Width =1365
                    Height =60
                    BackColor =-2147483603
                    Name ="CeldaVacía1575"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleBottom =1
                    GridlineColor =8355711
                    HorizontalAnchor =2
                    LayoutCachedLeft =1305
                    LayoutCachedTop =360
                    LayoutCachedWidth =2670
                    LayoutCachedHeight =420
                    RowStart =2
                    RowEnd =2
                    ColumnStart =4
                    ColumnEnd =5
                    LayoutGroup =2
                    GridlineShade =50.0
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =2730
                    Width =450
                    Height =60
                    BackColor =-2147483603
                    Name ="CeldaVacía1576"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineColor =10921638
                    LayoutCachedLeft =2730
                    LayoutCachedWidth =3180
                    LayoutCachedHeight =60
                    ColumnStart =7
                    ColumnEnd =7
                    LayoutGroup =2
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =2730
                    Top =360
                    Width =450
                    Height =60
                    BackColor =-2147483603
                    Name ="CeldaVacía1578"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleBottom =1
                    GridlineColor =8355711
                    LayoutCachedLeft =2730
                    LayoutCachedTop =360
                    LayoutCachedWidth =3180
                    LayoutCachedHeight =420
                    RowStart =2
                    RowEnd =2
                    ColumnStart =7
                    ColumnEnd =7
                    LayoutGroup =2
                    GridlineShade =50.0
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =3180
                    Width =60
                    Height =60
                    BackColor =-2147483603
                    Name ="CeldaVacía1579"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineColor =8355711
                    LayoutCachedLeft =3180
                    LayoutCachedWidth =3240
                    LayoutCachedHeight =60
                    ColumnStart =8
                    ColumnEnd =8
                    LayoutGroup =2
                    GridlineShade =50.0
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =3180
                    Top =60
                    Width =60
                    Height =300
                    BackColor =-2147483603
                    Name ="CeldaVacía1580"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleRight =1
                    GridlineColor =8355711
                    VerticalAnchor =1
                    LayoutCachedLeft =3180
                    LayoutCachedTop =60
                    LayoutCachedWidth =3240
                    LayoutCachedHeight =360
                    RowStart =1
                    RowEnd =1
                    ColumnStart =8
                    ColumnEnd =8
                    LayoutGroup =2
                    GridlineShade =50.0
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =3180
                    Top =360
                    Width =60
                    Height =60
                    BackColor =-2147483603
                    Name ="CeldaVacía1581"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineColor =8355711
                    LayoutCachedLeft =3180
                    LayoutCachedTop =360
                    LayoutCachedWidth =3240
                    LayoutCachedHeight =420
                    RowStart =2
                    RowEnd =2
                    ColumnStart =8
                    ColumnEnd =8
                    LayoutGroup =2
                    GridlineShade =50.0
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =2670
                    Width =60
                    Height =60
                    BackColor =-2147483603
                    Name ="CeldaVacía1582"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleTop =1
                    GridlineColor =10921638
                    LayoutCachedLeft =2670
                    LayoutCachedWidth =2730
                    LayoutCachedHeight =60
                    ColumnStart =6
                    ColumnEnd =6
                    LayoutGroup =2
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =2670
                    Top =60
                    Width =60
                    Height =300
                    BackColor =-2147483603
                    Name ="CeldaVacía1583"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638
                    VerticalAnchor =1
                    LayoutCachedLeft =2670
                    LayoutCachedTop =60
                    LayoutCachedWidth =2730
                    LayoutCachedHeight =360
                    RowStart =1
                    RowEnd =1
                    ColumnStart =6
                    ColumnEnd =6
                    LayoutGroup =2
                    GroupTable =3
                End
                Begin EmptyCell
                    BackStyle =1
                    Left =2670
                    Top =360
                    Width =60
                    Height =60
                    BackColor =-2147483603
                    Name ="CeldaVacía1584"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleBottom =1
                    GridlineColor =8355711
                    LayoutCachedLeft =2670
                    LayoutCachedTop =360
                    LayoutCachedWidth =2730
                    LayoutCachedHeight =420
                    RowStart =2
                    RowEnd =2
                    ColumnStart =6
                    ColumnEnd =6
                    LayoutGroup =2
                    GridlineShade =50.0
                    GroupTable =3
                End
                Begin CommandButton
                    OverlapFlags =87
                    Left =2730
                    Top =60
                    Width =450
                    Height =300
                    FontSize =8
                    TabIndex =2
                    Name ="DS_LIST_ITEM_ADD"
                    Caption ="ADD"
                    OnClick ="[Event Procedure]"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638
                    VerticalAnchor =1

                    CursorOnHover =1
                    LayoutCachedLeft =2730
                    LayoutCachedTop =60
                    LayoutCachedWidth =3180
                    LayoutCachedHeight =360
                    RowStart =1
                    RowEnd =1
                    ColumnStart =7
                    ColumnEnd =7
                    LayoutGroup =2
                    ForeThemeColorIndex =1
                    ForeTint =100.0
                    Shape =0
                    Gradient =0
                    BackColor =13998939
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    BorderWidth =1
                    BorderThemeColorIndex =8
                    BorderTint =100.0
                    ThemeFontIndex =-1
                    HoverThemeColorIndex =8
                    HoverTint =80.0
                    PressedThemeColorIndex =8
                    PressedShade =80.0
                    HoverForeThemeColorIndex =1
                    HoverForeTint =100.0
                    PressedForeThemeColorIndex =1
                    PressedForeTint =100.0
                    GroupTable =3
                    QuickStyle =13
                    QuickStyleMask =-1
                    WebImagePaddingRight =-1
                    WebImagePaddingBottom =-1
                    Overlaps =1
                End
                Begin CommandButton
                    OverlapFlags =87
                    Left =2115
                    Top =60
                    Width =555
                    Height =300
                    FontSize =8
                    TabIndex =1
                    Name ="DS_LIST_ITEM_EDIT"
                    Caption ="EDIT"
                    OnClick ="[Event Procedure]"
                    GroupTable =3
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineColor =10921638
                    VerticalAnchor =1

                    CursorOnHover =1
                    LayoutCachedLeft =2115
                    LayoutCachedTop =60
                    LayoutCachedWidth =2670
                    LayoutCachedHeight =360
                    RowStart =1
                    RowEnd =1
                    ColumnStart =5
                    ColumnEnd =5
                    LayoutGroup =2
                    ForeThemeColorIndex =1
                    ForeTint =100.0
                    WidthStretch =50
                    Shape =0
                    Gradient =0
                    BackColor =13998939
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    BorderWidth =1
                    BorderThemeColorIndex =8
                    BorderTint =100.0
                    ThemeFontIndex =-1
                    HoverThemeColorIndex =8
                    HoverTint =80.0
                    PressedThemeColorIndex =8
                    PressedShade =80.0
                    HoverForeThemeColorIndex =1
                    HoverForeTint =100.0
                    PressedForeThemeColorIndex =1
                    PressedForeTint =100.0
                    GroupTable =3
                    QuickStyle =13
                    QuickStyleMask =-1
                    WebImagePaddingRight =-1
                    WebImagePaddingBottom =-1
                    Overlaps =1
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private WithEvents pGridController As dsGridController
Attribute pGridController.VB_VarHelpID = -1
Private WithEvents pController As dsTaskController
Attribute pController.VB_VarHelpID = -1
Private WithEvents pContinuousList As Form_DS_RICHTEXT_LIST
Attribute pContinuousList.VB_VarHelpID = -1
Private pFailedSequenceIndex As Long
Private rsX As RecordsetEx
Private pIndexCountdown As Long

Property Get IsSubform() As Boolean
    On Error Resume Next
    IsSubform = Len(Me.Parent.Name) > 0
End Property

Public Property Get Controller() As dsTaskController: Set Controller = pController: End Property
Public Property Set Controller(ByRef Value As dsTaskController): SetTaskController Value: End Property
Public Property Get GridController() As dsGridController: Set GridController = pGridController: End Property
Public Property Set GridController(ByRef Value As dsGridController): Set pGridController = Value: End Property


Private Sub SetTaskController(ByRef Value As dsTaskController)
    Set pController = Value
    RebuildSequenceList
End Sub

Private Sub DS_LIST_ITEM_ADD_Click()
    Dim frm As Access.Form, ActiveTaskName As String
    
    If pController.Initialized Then
        ActiveTaskName = pController.RebuildSequence(pController.SequenceIndex)("TaskName")
    Else
        ActiveTaskName = ""
    End If
    CloseFormIfOpen "DS_CREATE_TASK"
    DoCmd.OpenForm "DS_CREATE_TASK"
    Set frm = Forms("DS_CREATE_TASK")
    WindowCenterTo frm, ScreenLib.GetScreenRectOfPoint(PointInRect(GetWindowRect(Me), DirectionType.Center))
    frm.ActiveTaskName = ActiveTaskName
    frm.ActiveTaskIndex = pController.SequenceIndex
    frm.EditMode = False
    Set frm.Controller = pGridController
    WindowAndTaskbarIconAsVisible frm
End Sub

Private Sub DS_LIST_ITEM_EDIT_Click()
    ShowCreateTaskFormInEditMode pController.SequenceIndex
End Sub

Private Sub ShowCreateTaskFormInEditMode(ByVal TaskIndex As Long)
    Dim frm As Access.Form, ActiveTaskName As String
    
    If pController.Initialized Then
        ActiveTaskName = pController.RebuildSequence(TaskIndex)("TaskName")
    Else
        ActiveTaskName = ""
    End If
    CloseFormIfOpen "DS_CREATE_TASK"
    DoCmd.OpenForm "DS_CREATE_TASK"
    Set frm = Forms("DS_CREATE_TASK")
    WindowCenterTo frm, ScreenLib.GetScreenRectOfPoint(PointInRect(GetWindowRect(Me), DirectionType.Center))
    frm.ActiveTaskName = ActiveTaskName
    frm.ActiveTaskIndex = TaskIndex
    frm.EditMode = True
    Set frm.Controller = pGridController
    WindowAndTaskbarIconAsVisible frm
End Sub

Private Sub CloseFormIfOpen(ByVal FormName As String)
    On Error Resume Next
    DoCmd.Close acForm, FormName, acSaveNo
End Sub

Private Sub DS_LIST_ITEM_REMOVE_Click()
    Dim aX As ArrayListEx
    
    Set aX = ArrayListEx.Create(pController.RebuildSequence)
    aX.RemoveAt pController.SequenceIndex
    Set pController.RebuildSequence = aX
End Sub

Private Sub Form_Load()
    Debug.Print "IN DS_REBUILD_SEQUENCE.Load()"
    pFailedSequenceIndex = -1
End Sub

Private Function CreateListItemHeader(Optional ByVal Title As String = "") As Variant
    pIndexCountdown = pIndexCountdown - 1
    
    If Trim(Title) = "" Then
        CreateListItemHeader = Array(pIndexCountdown, Title, 4)
    Else
        CreateListItemHeader = Array(pIndexCountdown, _
            "<div align=center><font face=""72 Black"" size=1 color=""#A5A5A5"">" & Title & "</font><font color=white>&nbsp;&nbsp;.<br>" & _
            "</font><font style=""BACKGROUND-COLOR:#808080"">______ _______ _________ ________ ________ _______ ____ ______ _____</font></div>", _
            4)
    End If
End Function

Public Sub RebuildSequenceList()
    Dim dX As New DictionaryEx, i As Long, qList As New ArrayListEx, activeTaskGroup As String, sAux As String, dsT As dsTable, dirtyIndex As Long, seqIndex As Long, lState As Long
    seqIndex = pController.SequenceIndex
    dirtyIndex = pController.DirtyRebuildIndex
    pIndexCountdown = 0

    For i = 0 To pController.RebuildSequence.Count - 1
        dX.Bind pController.RebuildSequence(i)
        If pFailedSequenceIndex = i Then
            lState = 3
        Else
            lState = IIf(i >= dirtyIndex, 0, 1)
        End If
        Select Case Left(pController.TaskInfo(dX("TaskName"))(4), 1)
            Case "X": sAux = "X"
            Case Else: sAux = "T"
        End Select
        If activeTaskGroup <> sAux Then
            qList.Add CreateListItemHeader(" ")
            Select Case sAux
                Case "X": qList.Add CreateListItemHeader("XL FORMATTING TASKS")
                Case Else: qList.Add CreateListItemHeader("TRANSFORMATION TASKS")
            End Select
            activeTaskGroup = sAux
        End If
        qList.Add Array(i, "<b>" & dX("Id") & "</b> " & dX("TaskName"), lState)
    Next i
    qList.Add CreateListItemHeader(" ")
    qList.RemoveAt 0
    
    Set dsT = dsTable.Create(qList).SetHeaders(Array("DS_LIST_ITEM_INDEX", "DS_LIST_ITEM", "DS_LIST_ITEM_STATE"))
    Set rsX = RecordsetEx.Create(dsT.NamedRecordset)
    Set Me.DS_SEQUENCE_LIST.Form.Recordset = rsX.Instance
    If pContinuousList Is Nothing Then
        Set pContinuousList = Me.DS_SEQUENCE_LIST.Form
        pContinuousList.SetActiveIndex seqIndex
    End If
End Sub

Private Sub Form_Resize()
    Me.DS_SEQUENCE_LIST.HorizontalAnchor = acHorizontalAnchorBoth
    Me.DS_SEQUENCE_LIST.VerticalAnchor = acVerticalAnchorBoth
    Me.DS_FOOTER_CELL_GROW.HorizontalAnchor = acHorizontalAnchorBoth
End Sub

Private Sub Form_Unload(Cancel As Integer)
    ' Debug.Print "[INFO] @DS_REBUILD_SEQUENCE.Unload()"
End Sub

Private Sub pContinuousList_OnActiveIndexChange(ByVal ActiveIndex As Long)
    On Error Resume Next
'    If pController.SequenceIndex <> ActiveIndex Then
        pController.SequenceIndex = ActiveIndex
'        RebuildSequenceList
'    End If
End Sub

Private Sub pContinuousList_OnItemDoubleClick(ByVal ActiveIndex As Long)
    ShowCreateTaskFormInEditMode ActiveIndex
End Sub

Private Sub pContinuousList_OnNoActiveIndexChange(ByVal ActiveIndex As Long)
    pController.SequenceIndex = ActiveIndex
End Sub

Private Sub pController_OnActiveSequenceIndexChange(ByVal TargetIndex As Long)
    On Error Resume Next
    Debug.Print "[EVENT] @DS_REBUILD_SEQUENCE.pController_OnActiveSequenceIndexChange()"
    ' TODO: REBUILD?
    RebuildSequenceList
    pContinuousList.SetActiveIndex pController.SequenceIndex, True
End Sub

Private Sub pController_OnRebuildSequenceChange()
    Debug.Print "[EVENT] @DS_REBUILD_SEQUENCE.pController_OnRebuildSequenceChange()"
    pFailedSequenceIndex = -1
    RebuildSequenceList
End Sub

Private Sub pController_OnRebuildSequenceFail(ByVal FailedSequenceIndex As Long)
    On Error Resume Next
    Debug.Print "[EVENT] @DS_REBUILD_SEQUENCE.pController_OnRebuildSequenceFail()"
    pFailedSequenceIndex = FailedSequenceIndex
    RebuildSequenceList
    pContinuousList.SetActiveIndex pFailedSequenceIndex, True
End Sub
